<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8">
<meta name="referrer" content="no-referrer">
<title>使用 Java 实现简单的 WebServer - Yu</title>
<base href="/">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<link rel="canonical" href="https://mvbbb.github.io/cxnppw/">
<link rel="icon" type="image/x-icon" href="/images/web.png">

<meta name="description" content="Web Server 的功能: 根据用户提供的 Http request, Web Server 返回对应的 Http response. Web Server 也只不过是一个 Application.">
<meta property="og:type" content="website">
<meta property="og:title" content="使用 Java 实现简单的 WebServer">
<meta property="og:url" content="https://mvbbb.github.io/cxnppw/index.html">
<meta property="og:site_name" content="Yu">
<meta property="og:description" content="Web Server 的功能: 根据用户提供的 Http request, Web Server 返回对应的 Http response. Web Server 也只不过是一个 Application.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://mvbbb.github.io/cxnppw/images/avatar.jpg">
<meta property="article:published_time" content="2020-11-24T13:43:44.000Z">
<meta property="article:modified_time" content="2021-02-03T04:20:59.209Z">
<meta property="article:author" content="Mvbbb">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Socket">
<meta property="article:tag" content="NetWork">
<meta property="article:tag" content="Http">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mvbbb.github.io/cxnppw/images/avatar.jpg">
<script type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","publisher":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"url":"https://mvbbb.github.io","image":"https://mvbbb.github.io/images/avatar.jpg","description":"Who i am,who u are","author":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"inLanguage":{"@type":"Language","alternateName":"en"}},{"@context":"http://schema.org","@type":"Article","articleSection":"计算机网络","url":"https://mvbbb.github.io/cxnppw/","headline":"使用 Java 实现简单的 WebServer","image":"https://mvbbb.github.io/images/avatar.jpg","datePublished":"2020-11-24T13:43:44.000Z","dateModified":"2021-02-03T04:20:59.209Z","keywords":"Java,Socket,NetWork,Http","description":"Web Server 的功能: 根据用户提供的 Http request, Web Server 返回对应的 Http response. Web Server 也只不过是一个 Application.","publisher":{"@type":"Organization","name":"Yu","logo":{"@type":"ImageObject","url":"https://mvbbb.github.io/images/avatar.jpg"}},"author":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"inLanguage":{"@type":"Language","alternateName":"en"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mvbbb.github.io/cxnppw/"}}]</script><link rel="alternate" type="application/atom+xml" title="Yu" href="/rss2.xml">
<script async="" src="//www.googletagmanager.com/gtag/js?id=UA-160027215-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)};gtag('js',new Date());gtag('config','UA-160027215-1');</script>
<meta name="theme-color" content=""><script type="application/json" is="state">{&q;api/Y3hucHB3.json&q;:{&q;title&q;:&q;使用 Java 实现简单的 WebServer&q;,&q;date&q;:&q;2020-11-24T13:43:44.000Z&q;,&q;date_formatted&q;:{&q;ll&q;:&q;Nov 24, 2020&q;,&q;L&q;:&q;11/24/2020&q;,&q;MM-DD&q;:&q;11-24&q;},&q;link&q;:&q;cxnppw&q;,&q;comments&q;:true,&q;tags&q;:[&q;Http&q;,&q;Java&q;,&q;NetWork&q;,&q;Socket&q;],&q;categories&q;:[&q;计算机网络&q;],&q;updated&q;:&q;2021-02-03T04:20:59.209Z&q;,&q;content&q;:&q;&l;p&g;&l;strong&g;Web Server 的功能: 根据用户提供的 Http request, Web Server 返回对应的 Http response. Web Server 也只不过是一个 Application.&l;/strong&g;&l;/p&g;\n&l;a id=\&q;more\&q;&g;&l;/a&g;\n&l;h1 id=\&q;预备知识\&q;&g;预备知识&l;a title=\&q;#预备知识\&q; href=\&q;#预备知识\&q;&g;&l;/a&g;&l;/h1&g;\n&l;ul&g;\n&l;li&g;socket 的基本使用&l;/li&g;\n&l;li&g;HTTP 协议&l;/li&g;\n&l;li&g;Java 知识&l;/li&g;\n&l;/ul&g;\n&l;h2 id=\&q;socket-的基本使用\&q;&g;Socket 的基本使用&l;a title=\&q;#socket-的基本使用\&q; href=\&q;#socket-的基本使用\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;Socekt 是同一台主机内, 应用层与传输层之间的&l;strong&g;接口&l;/strong&g;. 两个程序通过彼此的 Socket 接口进行信息交换, 建立在 Socket 上的程序不需要关心底层的实现.&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;Socket 方法&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;function\&q;&g;InetAddress &l;span class=\&q;title\&q;&g;getInetAddress&l;/span&g;&l;span class=\&q;params\&q;&g;()&l;/span&g; : 返回socket连接的地址&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;int&l;/span&g; &l;span class=\&q;title\&q;&g;getPort&l;/span&g;&l;span class=\&q;params\&q;&g;()&l;/span&g;: 返回远程连接这socket的端口&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;function\&q;&g;InetAddress &l;span class=\&q;title\&q;&g;getLocalAddress&l;/span&g;&l;span class=\&q;params\&q;&g;()&l;/span&g;: 获取该socket绑定的本地地址&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;int&l;/span&g; &l;span class=\&q;title\&q;&g;getLocalPort&l;/span&g;&l;span class=\&q;params\&q;&g;()&l;/span&g; : 获取这socket绑定的本地端口&l;/span&g;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;h2 id=\&q;http-协议\&q;&g;HTTP 协议&l;a title=\&q;#http-协议\&q; href=\&q;#http-协议\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;HTTP 是一个基于 TCP/IP 通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）, 是客户端和服务器交互的一种通迅的格式.&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606271561591-3af625f9-855a-4fd8-839b-1c451ae0f0ea.png#align=left&a;amp;display=inline&a;amp;height=576&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=1524291150623-eb2eb938-d4b8-41e1-a848-6567cb70cbb1.png&a;amp;originHeight=576&a;amp;originWidth=1184&a;amp;size=289776&a;amp;status=done&a;amp;style=none&a;amp;width=1184\&q; alt=\&q;1524291150623-eb2eb938-d4b8-41e1-a848-6567cb70cbb1.png\&q;&g;&l;br&g;\n&l;strong&g;Http 请求&l;/strong&g;&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606272412562-583dccd8-43a3-4215-914e-09d5841d89e3.png#align=left&a;amp;display=inline&a;amp;height=219&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=438&a;amp;originWidth=1448&a;amp;size=80530&a;amp;status=done&a;amp;style=none&a;amp;width=724\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n&l;strong&g;Http 响应&l;/strong&g;&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606272511628-42ec0e43-29d7-4631-bad9-75e6e6c4973f.png#align=left&a;amp;display=inline&a;amp;height=95&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=189&a;amp;originWidth=1457&a;amp;size=20968&a;amp;status=done&a;amp;style=none&a;amp;width=728.5\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606272567823-60950fa0-18da-4a1b-ac1d-702a5f7daaed.png#align=left&a;amp;display=inline&a;amp;height=350&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=700&a;amp;originWidth=1440&a;amp;size=100714&a;amp;status=done&a;amp;style=none&a;amp;width=720\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n首先, 用户浏览器向服务器发送 HTTP 请求来获取资源. 之后服务器回复 HTTP 响应. 在本程序中, HTTP 请求有浏览器发出, Java 程序负责响应用户请求, 并返回 HTTP 响应报文. 它们通过 Socket 接口进行 HTTP 报文交换.&l;/p&g;\n&l;h2 id=\&q;java-知识\&q;&g;Java 知识&l;a title=\&q;#java-知识\&q; href=\&q;#java-知识\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;使用到 Java 中的两个主要类来实现 Web Server: java.net.ServerSocket, java.net.ServerSocket&l;br&g;\n下图是 TCP 中客户套接字和服务器套接字的连接方式&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606226153626-3a9197cc-b9ff-4e13-bd20-82dee4f0e140.png#align=left&a;amp;display=inline&a;amp;height=295&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=589&a;amp;originWidth=1094&a;amp;size=100586&a;amp;status=done&a;amp;style=none&a;amp;width=547\&q; alt=\&q;image.png\&q;&g;&l;br&g;\nServerSocket 对应上图中的 Welcoming Socket, Socket 对应上图中的 Connection Socket.&l;br&g;\nWelcoming Socket 监听请求, 当收到来自用户的请求, 就为其建立一个 Connection Socket.&l;/p&g;\n&l;h1 id=\&q;实现思路\&q;&g;实现思路&l;a title=\&q;#实现思路\&q; href=\&q;#实现思路\&q;&g;&l;/a&g;&l;/h1&g;\n&l;ol&g;\n&l;li&g;服务在指定端口进行监听，等待请求。&l;/li&g;\n&l;li&g;当接收到请求后，建立连接，新建一个线程，准备分析报文。&l;/li&g;\n&l;li&g;分析请求报文，对用户请求的网页进行查找，并读取内容。&l;/li&g;\n&l;li&g;构造响应报文的内容。&l;/li&g;\n&l;li&g;将响应报文发送给请求方。&l;/li&g;\n&l;/ol&g;\n&l;h1 id=\&q;代码实现\&q;&g;代码实现&l;a title=\&q;#代码实现\&q; href=\&q;#代码实现\&q;&g;&l;/a&g;&l;/h1&g;\n&l;h2 id=\&q;第一个版本\&q;&g;第一个版本&l;a title=\&q;#第一个版本\&q; href=\&q;#第一个版本\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;根据 HTTP 报文请求的 URL 返回给用户对应的资源.&l;br&g;\n代码实现和项目目录结构如下&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606274244639-8bcc8df0-5137-48ec-85a7-fd4025cffc8b.png#align=left&a;amp;display=inline&a;amp;height=64&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=128&a;amp;originWidth=481&a;amp;size=7262&a;amp;status=done&a;amp;style=none&a;amp;width=240.5\&q; alt=\&q;image.png\&q;&g;&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;14&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;15&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;16&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;17&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;18&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;19&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;20&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;21&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;22&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;23&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;24&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;25&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;26&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;27&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;28&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;29&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;30&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;31&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;32&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;33&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;34&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;35&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;36&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.io.BufferedReader;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.io.FileInputStream;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.io.InputStreamReader;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.io.OutputStream;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.net.ServerSocket;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.net.Socket;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;class\&q;&g;&l;span class=\&q;keyword\&q;&g;class&l;/span&g; &l;span class=\&q;title\&q;&g;HttpServer&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;keyword\&q;&g;static&l;/span&g; &l;span class=\&q;keyword\&q;&g;final&l;/span&g; String webroot= &l;span class=\&q;string\&q;&g;&a;quot;version1/WebRoot/&a;quot;&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;keyword\&q;&g;static&l;/span&g; &l;span class=\&q;keyword\&q;&g;void&l;/span&g; &l;span class=\&q;title\&q;&g;main&l;/span&g;&l;span class=\&q;params\&q;&g;(String[] args)&l;/span&g; &l;span class=\&q;keyword\&q;&g;throws&l;/span&g; Exception &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;/*在80端口监听的 Welcoming Socekt*/&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        ServerSocket serverSocket = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; ServerSocket(&l;span class=\&q;number\&q;&g;80&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;/* accept 是一个阻塞方法, 会一直监听, 建立连接之后返回一个 Connection Socket */&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;服务器端等待请求&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        Socket socket = serverSocket.accept();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;成功建立连接&a;quot;&l;/span&g;+socket.toString());&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;/*用于获取 socket 接收的服务端请求报文*/&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        BufferedReader reader = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; BufferedReader(&l;span class=\&q;keyword\&q;&g;new&l;/span&g; InputStreamReader(socket.getInputStream()));&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;/*Http请求行*/&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        String httpRequestLine = reader.readLine();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;/*请求的 uri*/&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        String uri = httpRequestLine.split(&l;span class=\&q;string\&q;&g;&a;quot; &a;quot;&l;/span&g;)[&l;span class=\&q;number\&q;&g;1&l;/span&g;];&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        String url=webroot+uri;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;/*从磁盘中取出用户请求的资源文件, 并放回给用户*/&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        FileInputStream fileInputStream = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; FileInputStream(url);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        OutputStream outputStream = socket.getOutputStream();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;byte&l;/span&g;[] buffer = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; &l;span class=\&q;keyword\&q;&g;byte&l;/span&g;[&l;span class=\&q;number\&q;&g;1024&l;/span&g;];&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;int&l;/span&g; length=&l;span class=\&q;number\&q;&g;0&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;while&l;/span&g;((length=fileInputStream.read(buffer))!=-&l;span class=\&q;number\&q;&g;1&l;/span&g;)&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            outputStream.write(buffer, &l;span class=\&q;number\&q;&g;0&l;/span&g;, length);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;成功发送给用户&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        outputStream.flush();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        socket.close();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&a;#125;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606274263910-c5d61a1a-47da-45ea-b722-2d7d33f34bad.png#align=left&a;amp;display=inline&a;amp;height=88&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=176&a;amp;originWidth=1805&a;amp;size=27703&a;amp;status=done&a;amp;style=none&a;amp;width=902.5\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606274276825-2a66e075-e90c-4ced-a29f-721513035603.png#align=left&a;amp;display=inline&a;amp;height=107&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=214&a;amp;originWidth=1636&a;amp;size=14089&a;amp;status=done&a;amp;style=none&a;amp;width=818\&q; alt=\&q;image.png\&q;&g;&l;/p&g;\n&l;h2 id=\&q;第二个版本\&q;&g;第二个版本&l;a title=\&q;#第二个版本\&q; href=\&q;#第二个版本\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;1 . 在第一个版本中假如用户请求一个服务器没有的资源, 服务器会报异常, 这一点需要改进. 资源不存在的时候应该返回 404 界面&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606274568269-7c83b37a-2166-4d1d-adf1-21bdefe42168.png#align=left&a;amp;display=inline&a;amp;height=112&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=223&a;amp;originWidth=1705&a;amp;size=53527&a;amp;status=done&a;amp;style=none&a;amp;width=852.5\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n2 . 用户可能不止一次的请求服务器, 我们需要使用循环, 不断监听用户请求.&l;br&g;\n3 . 真实情况下, 服务器不止处理一个用户的请求, 在第一个版本中我们只能处理一个用户的请求, 因此我们需要使用多线程, 同时处理多个用户的请求.&l;br&g;\n4 . 实现 GET/POST, 并返回标准的 HTTP response&l;/p&g;\n&l;p&g;代码实现和目录结构如下&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606395502266-9889c3a9-7fd2-4532-840e-ee20a6f69f37.png#align=left&a;amp;display=inline&a;amp;height=74&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=148&a;amp;originWidth=358&a;amp;size=8216&a;amp;status=done&a;amp;style=none&a;amp;width=179\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n代码仓库 &l;a href=\&q;https://github.com/Mvbbb/small-java-demo/blob/master/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/WebServer.java\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;HTTP 服务器&l;/a&g;&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;14&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;15&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;16&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;17&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;18&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;19&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;20&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;21&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;22&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;23&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;24&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;25&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;26&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;27&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;28&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;29&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;30&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;31&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;32&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;33&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;34&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;35&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;36&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;37&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;38&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;39&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;40&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;41&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;42&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;43&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;44&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;45&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;46&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;47&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;48&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;49&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;50&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;51&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;52&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;53&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;54&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;55&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;56&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;57&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;58&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;59&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;60&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;61&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;62&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;63&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;64&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;65&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;66&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;67&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;68&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;69&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;70&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;71&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;72&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;73&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;74&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;75&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;76&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;77&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;78&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;79&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;80&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;81&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;82&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;83&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;84&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;85&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;86&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;87&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;88&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;89&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;90&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;91&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;92&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;93&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;94&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;95&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;96&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;97&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;98&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;99&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;100&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;101&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;102&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;103&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;104&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;105&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;106&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;107&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;108&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;109&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;110&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;111&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;112&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;113&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;114&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;115&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;116&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;117&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;118&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;119&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;120&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;121&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;122&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;123&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;124&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;125&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;126&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;127&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;128&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;129&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;130&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;131&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;132&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;133&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;134&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;135&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;136&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;137&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;138&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;139&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;140&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;141&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;142&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;143&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;144&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;145&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;146&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;147&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;148&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;149&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;150&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;151&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;152&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;153&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;154&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;155&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;156&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;157&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;158&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;159&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;160&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;161&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;162&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;163&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;164&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;165&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;166&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;167&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;168&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;169&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;170&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;171&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;172&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;173&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;174&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;175&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;176&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;177&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;178&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;179&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;180&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;181&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;182&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;183&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;184&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;185&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;186&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;187&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;188&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;189&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;190&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;191&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;192&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;193&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;194&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;195&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;196&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;197&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;198&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;199&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;200&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;201&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;202&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;203&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;204&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;205&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;206&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;207&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;208&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;209&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;210&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;211&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.io.*;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.net.ServerSocket;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.net.Socket;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.util.HashMap;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.util.Map;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.util.Scanner;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;import&l;/span&g; java.util.Set;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;class\&q;&g;&l;span class=\&q;keyword\&q;&g;class&l;/span&g; &l;span class=\&q;title\&q;&g;WebServer&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;keyword\&q;&g;static&l;/span&g; &l;span class=\&q;keyword\&q;&g;void&l;/span&g; &l;span class=\&q;title\&q;&g;main&l;/span&g;&l;span class=\&q;params\&q;&g;(String[] args)&l;/span&g; &l;span class=\&q;keyword\&q;&g;throws&l;/span&g; IOException &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        ServerSocket serverSocket=&l;span class=\&q;keyword\&q;&g;new&l;/span&g; ServerSocket(&l;span class=\&q;number\&q;&g;8000&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;while&l;/span&g;(&l;span class=\&q;keyword\&q;&g;true&l;/span&g;)&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            Socket socket= serverSocket.accept();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;new&l;/span&g; Thread(&l;span class=\&q;keyword\&q;&g;new&l;/span&g; MyHttpServer(socket)).start();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;/**&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g; * 处理一个 Connection Socket 的请求的 HttpServer&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g; */&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;class\&q;&g;&l;span class=\&q;keyword\&q;&g;class&l;/span&g; &l;span class=\&q;title\&q;&g;MyHttpServer&l;/span&g; &l;span class=\&q;keyword\&q;&g;implements&l;/span&g; &l;span class=\&q;title\&q;&g;Runnable&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;final&l;/span&g; String CRLF=&l;span class=\&q;string\&q;&g;&a;quot;\\r\\n&a;quot;&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; Socket socket;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; String webroot;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;title\&q;&g;MyHttpServer&l;/span&g;&l;span class=\&q;params\&q;&g;(Socket socket)&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;连接到服务器的用户: &a;quot;&l;/span&g;+socket);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;this&l;/span&g;.socket = socket;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;// 服务器的资源根目录是当前用户的工作目录&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        webroot=System.getProperties().getProperty(&l;span class=\&q;string\&q;&g;&a;quot;user.dir&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;/**&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * 目前只是实现了解析 HTTP 请求&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     */&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;meta\&q;&g;@Override&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;keyword\&q;&g;void&l;/span&g; &l;span class=\&q;title\&q;&g;run&l;/span&g;&l;span class=\&q;params\&q;&g;()&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        BufferedReader reader=&l;span class=\&q;keyword\&q;&g;null&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        PrintWriter printWriter=&l;span class=\&q;keyword\&q;&g;null&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;try&l;/span&g; &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 读取输入&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            reader = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; BufferedReader(&l;span class=\&q;keyword\&q;&g;new&l;/span&g; InputStreamReader(socket.getInputStream()));&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 写输出&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            printWriter = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; PrintWriter(socket.getOutputStream(), &l;span class=\&q;keyword\&q;&g;true&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 读入请求行&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String requestLine = reader.readLine();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;if&l;/span&g;(requestLine==&l;span class=\&q;keyword\&q;&g;null&l;/span&g;)&l;span class=\&q;keyword\&q;&g;return&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 请求行参数: POST/GET 请求uri HTTP版本&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String[] requstLineArgs = requestLine.split(&l;span class=\&q;string\&q;&g;&a;quot; &a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 读入请求头&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String line = &l;span class=\&q;keyword\&q;&g;null&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String[] keyValue = &l;span class=\&q;keyword\&q;&g;null&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            Map&a;lt;String, String&a;gt; requestHeaders = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; HashMap&a;lt;String, String&a;gt;();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;while&l;/span&g; ((line = reader.readLine()) != &l;span class=\&q;keyword\&q;&g;null&l;/span&g; &a;amp;&a;amp; !&l;span class=\&q;string\&q;&g;&a;quot;&a;quot;&l;/span&g;.equals(line)) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                &l;span class=\&q;keyword\&q;&g;int&l;/span&g; i = line.indexOf(&l;span class=\&q;string\&q;&g;&a;quot;: &a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                requestHeaders.put(line.substring(&l;span class=\&q;number\&q;&g;0&l;/span&g;,i),line.substring(i+&l;span class=\&q;number\&q;&g;2&l;/span&g;));&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 展示HTTP请求行中的参数&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;用户&a;quot;&l;/span&g;+socket.getPort()+&l;span class=\&q;string\&q;&g;&a;quot;请求方法: &a;quot;&l;/span&g;+requstLineArgs[&l;span class=\&q;number\&q;&g;0&l;/span&g;]);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;用户&a;quot;&l;/span&g;+socket.getPort()+&l;span class=\&q;string\&q;&g;&a;quot;请求地址: &a;quot;&l;/span&g;+requstLineArgs[&l;span class=\&q;number\&q;&g;1&l;/span&g;]);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;用户&a;quot;&l;/span&g;+socket.getPort()+&l;span class=\&q;string\&q;&g;&a;quot;的HTTP版本: &a;quot;&l;/span&g;+requstLineArgs[&l;span class=\&q;number\&q;&g;2&l;/span&g;]);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 展示Http 请求头中的参数&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;********************&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;用户&a;quot;&l;/span&g;+socket.getPort()+&l;span class=\&q;string\&q;&g;&a;quot;请求头参数&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            showMapValue(requestHeaders);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;********************&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 如果是POST方法继续读入请求体&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;if&l;/span&g; (&l;span class=\&q;string\&q;&g;&a;quot;POST&a;quot;&l;/span&g;.equals(requstLineArgs[&l;span class=\&q;number\&q;&g;0&l;/span&g;])) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                doPost(requstLineArgs, requestHeaders, reader, printWriter);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 如果是GET方法就解析uri&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;if&l;/span&g; (&l;span class=\&q;string\&q;&g;&a;quot;GET&a;quot;&l;/span&g;.equals(requstLineArgs[&l;span class=\&q;number\&q;&g;0&l;/span&g;])) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                doGet(requstLineArgs, requestHeaders, printWriter);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125; &l;span class=\&q;keyword\&q;&g;catch&l;/span&g; (IOException e) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            e.printStackTrace();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125; &l;span class=\&q;keyword\&q;&g;finally&l;/span&g; &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;if&l;/span&g; (reader != &l;span class=\&q;keyword\&q;&g;null&l;/span&g;) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                &l;span class=\&q;keyword\&q;&g;try&l;/span&g; &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                    reader.close();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                &a;#125; &l;span class=\&q;keyword\&q;&g;catch&l;/span&g; (IOException e) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                    e.printStackTrace();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;if&l;/span&g; (printWriter != &l;span class=\&q;keyword\&q;&g;null&l;/span&g;) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                printWriter.close();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;if&l;/span&g;(socket!=&l;span class=\&q;keyword\&q;&g;null&l;/span&g;)&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                &l;span class=\&q;keyword\&q;&g;try&l;/span&g; &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                    System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;关闭与服务器连接的用户: &a;quot;&l;/span&g;+socket);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                    System.out.println();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                    socket.close();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                &a;#125; &l;span class=\&q;keyword\&q;&g;catch&l;/span&g; (IOException e) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                    e.printStackTrace();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;/**&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * 请求行中是 GET 方法&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; requestLineArgs&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; requestHeaders&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; printWriter&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     */&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;keyword\&q;&g;void&l;/span&g; &l;span class=\&q;title\&q;&g;doGet&l;/span&g;&l;span class=\&q;params\&q;&g;(String[] requestLineArgs,Map&a;lt;String,String&a;gt; requestHeaders,PrintWriter printWriter)&l;/span&g;&l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;// GET 的 requestLine 的解析&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;int&l;/span&g; i = requestLineArgs[&l;span class=\&q;number\&q;&g;1&l;/span&g;].indexOf(&l;span class=\&q;string\&q;&g;&a;#x27;?&a;#x27;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;// GET 有参数&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;if&l;/span&g;(i!=-&l;span class=\&q;number\&q;&g;1&l;/span&g;) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 将参数放入到 getArgs 中&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String sourceUri = requestLineArgs[&l;span class=\&q;number\&q;&g;1&l;/span&g;].substring(&l;span class=\&q;number\&q;&g;0&l;/span&g;, i);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String[] s = requestLineArgs[&l;span class=\&q;number\&q;&g;1&l;/span&g;].substring(i + &l;span class=\&q;number\&q;&g;1&l;/span&g;).split(&l;span class=\&q;string\&q;&g;&a;quot;&a;amp;&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String[] keyValue = &l;span class=\&q;keyword\&q;&g;null&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            Map&a;lt;String, String&a;gt; getArgs = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; HashMap&a;lt;String, String&a;gt;();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;for&l;/span&g; (String ss : s) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                String[] split = ss.split(&l;span class=\&q;string\&q;&g;&a;quot;=&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                getArgs.put(split[&l;span class=\&q;number\&q;&g;0&l;/span&g;], split[&l;span class=\&q;number\&q;&g;1&l;/span&g;]);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 展示GET请求链接中的参数&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;********************&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;用户&a;quot;&l;/span&g;+socket.getPort()+&l;span class=\&q;string\&q;&g;&a;quot;GET 中的参数&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            showMapValue(getArgs);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;********************&a;quot;&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            writeFile(printWriter,requestHeaders,sourceUri);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;span class=\&q;keyword\&q;&g;else&l;/span&g;&a;#123; &l;span class=\&q;comment\&q;&g;// 没有额外参数, 属于直接访问&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            writeFile(printWriter,requestHeaders,requestLineArgs[&l;span class=\&q;number\&q;&g;1&l;/span&g;]);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;/**&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * 请求行中是 POST 方法, 现在还不会处理POST方法, 先挖坑&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; requestLineArgs&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; requestHeaders&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; reader&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; printWriter&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     */&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;keyword\&q;&g;void&l;/span&g; &l;span class=\&q;title\&q;&g;doPost&l;/span&g;&l;span class=\&q;params\&q;&g;(String[] requestLineArgs,Map&a;lt;String,String&a;gt; requestHeaders,BufferedReader reader,PrintWriter printWriter)&l;/span&g;&l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        String sourceUri=requestLineArgs[&l;span class=\&q;number\&q;&g;1&l;/span&g;];&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;comment\&q;&g;// 还需要读入 requestBody&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;/**&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * 将用户请求的文件发送给用户&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; printWriter&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; requestHeaders&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; uri&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     */&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;keyword\&q;&g;void&l;/span&g; &l;span class=\&q;title\&q;&g;writeFile&l;/span&g;&l;span class=\&q;params\&q;&g;(PrintWriter printWriter,Map&a;lt;String,String&a;gt; requestHeaders,String uri)&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        String url=webroot+uri;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        System.out.println(&l;span class=\&q;string\&q;&g;&a;quot;用户&a;quot;&l;/span&g;+socket.getPort()+&l;span class=\&q;string\&q;&g;&a;quot;请求文件地址: &a;quot;&l;/span&g;+url);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        File file = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; File(url);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;try&l;/span&g; &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String statusLine=&l;span class=\&q;keyword\&q;&g;null&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String contentType=&l;span class=\&q;keyword\&q;&g;null&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            String entityBody=&l;span class=\&q;keyword\&q;&g;null&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;comment\&q;&g;// 请求的文件存在&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;             &l;span class=\&q;keyword\&q;&g;if&l;/span&g;(file.exists()&a;amp;&a;amp;file.isFile())&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                statusLine =&l;span class=\&q;string\&q;&g;&a;quot;HTTP/1.0 200 OK&a;quot;&l;/span&g;+CRLF;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                contentType=&l;span class=\&q;string\&q;&g;&a;quot;Content-Type&a;quot;&l;/span&g;  +contentType(file.toString())+CRLF;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                printWriter.print(statusLine);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                printWriter.print(contentType);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                printWriter.print(CRLF); &l;span class=\&q;comment\&q;&g;//之前的为响应行+响应头部, 之后的是响应正文, 之间用 CRLF 分隔&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 &l;span class=\&q;comment\&q;&g;// 将文件内容发送给用户&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 Scanner scanner = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; Scanner(&l;span class=\&q;keyword\&q;&g;new&l;/span&g; FileInputStream(file));&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 &l;span class=\&q;keyword\&q;&g;while&l;/span&g; (scanner.hasNextLine()) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                     printWriter.println(scanner.nextLine());&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 printWriter.flush();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;             &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;else&l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                statusLine=&l;span class=\&q;string\&q;&g;&a;quot;HTTP/1.0 404 Not Found&a;quot;&l;/span&g;+CRLF;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                contentType=&l;span class=\&q;string\&q;&g;&a;quot;Content-Type: text/html&a;quot;&l;/span&g;+CRLF;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                entityBody=&l;span class=\&q;string\&q;&g;&a;quot;&a;lt;HTML&a;gt;&a;quot;&l;/span&g; +&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                        &l;span class=\&q;string\&q;&g;&a;quot;&a;lt;HEAD&a;gt;&a;lt;TITLE&a;gt;Not Found&a;lt;/TITLE&a;gt;&a;lt;/HEAD&a;gt;&a;quot;&l;/span&g; +&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                        &l;span class=\&q;string\&q;&g;&a;quot;&a;lt;BODY&a;gt;Not Found&a;lt;/BODY&a;gt;&a;lt;/HTML&a;gt;&a;quot;&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 printWriter.print(statusLine);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 printWriter.print(contentType);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 printWriter.print(CRLF); &l;span class=\&q;comment\&q;&g;//之前的为响应行+响应头部, 之后的是响应正文, 之间用 CRLF 分隔&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 printWriter.print(entityBody);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;                 printWriter.flush();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;span class=\&q;keyword\&q;&g;catch&l;/span&g; (Exception e) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            e.printStackTrace();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;/**&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * 根据用户请求的文件类型, 返回符合mime标准的文件类型&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * 目前只实现了请求html文件的功能&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@param&l;/span&g; fileName&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     * &l;span class=\&q;doctag\&q;&g;@return&l;/span&g;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;     */&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; String &l;span class=\&q;title\&q;&g;contentType&l;/span&g;&l;span class=\&q;params\&q;&g;(String fileName)&l;/span&g;&l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;if&l;/span&g;(fileName.endsWith(&l;span class=\&q;string\&q;&g;&a;quot;.htm&a;quot;&l;/span&g;)||fileName.endsWith(&l;span class=\&q;string\&q;&g;&a;quot;.html&a;quot;&l;/span&g;))&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            &l;span class=\&q;keyword\&q;&g;return&l;/span&g; &l;span class=\&q;string\&q;&g;&a;quot;text/html&a;quot;&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;return&l;/span&g; &l;span class=\&q;string\&q;&g;&a;quot;&a;quot;&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;keyword\&q;&g;void&l;/span&g; &l;span class=\&q;title\&q;&g;showMapValue&l;/span&g;&l;span class=\&q;params\&q;&g;(Map&a;lt;String,String&a;gt; map)&l;/span&g;&l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        Set&a;lt;Map.Entry&a;lt;String, String&a;gt;&a;gt; entries = map.entrySet();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &l;span class=\&q;keyword\&q;&g;for&l;/span&g; (Map.Entry&a;lt;String, String&a;gt; entry : entries) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;            System.out.println(entry.getKey()+&l;span class=\&q;string\&q;&g;&a;quot;: &a;quot;&l;/span&g;+entry.getValue());&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&a;#125;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1606397469282-42f17800-1e86-4341-9542-b2acab5f250e.png#align=left&a;amp;display=inline&a;amp;height=515&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=1030&a;amp;originWidth=1920&a;amp;size=68141&a;amp;status=done&a;amp;style=none&a;amp;width=960\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n控制台打印&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;14&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;15&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;16&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;17&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;18&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;19&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;20&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;21&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;连接到服务器的用户: Socket[addr=/&l;span class=\&q;number\&q;&g;0&l;/span&g;:&l;span class=\&q;number\&q;&g;0&l;/span&g;:&l;span class=\&q;number\&q;&g;0&l;/span&g;:&l;span class=\&q;number\&q;&g;0&l;/span&g;:&l;span class=\&q;number\&q;&g;0&l;/span&g;:&l;span class=\&q;number\&q;&g;0&l;/span&g;:&l;span class=\&q;number\&q;&g;0&l;/span&g;:&l;span class=\&q;number\&q;&g;1&l;/span&g;,port=&l;span class=\&q;number\&q;&g;11148&l;/span&g;,localport=&l;span class=\&q;number\&q;&g;8000&l;/span&g;]&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;用户&l;span class=\&q;number\&q;&g;11147&l;/span&g;请求方法: GET&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;用户&l;span class=\&q;number\&q;&g;11147&l;/span&g;请求地址: /index.html&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;用户&l;span class=\&q;number\&q;&g;11147&l;/span&g;的HTTP版本: HTTP/&l;span class=\&q;number\&q;&g;1.1&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;********************&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;用户&l;span class=\&q;number\&q;&g;11147&l;/span&g;请求头参数&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;Cookie: Idea-48934e7a=d9468800-fffb-4bce-&l;span class=\&q;number\&q;&g;8707&l;/span&g;-98eda7648a0b; Webstorm-bee48fc1=&l;span class=\&q;number\&q;&g;645e8992&l;/span&g;-2d9b-&l;span class=\&q;number\&q;&g;4176&l;/span&g;-af5d-21b7e87ac442&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;Accept: text/html,application/xhtml+xml,application/xml;q=&l;span class=\&q;number\&q;&g;0.9&l;/span&g;,image/avif,image/webp,image/apng,*&l;span class=\&q;comment\&q;&g;/*;q=0.8,application/signed-exchange;v=b3;q=0.9&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Upgrade-Insecure-Requests: 1&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Connection: keep-alive&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Sec-Fetch-Site: none&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Sec-Fetch-Dest: document&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Host: localhost:8000&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Sec-Fetch-User: ?1&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Accept-Encoding: gzip, deflate, br&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Accept-Language: zh,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;Sec-Fetch-Mode: navigate&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;********************&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;用户11147请求文件地址: E:\\Desktop\\新建文件夹 (2)/index.html&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;关闭与服务器连接的用户: Socket[addr=/0:0:0:0:0:0:0:1,port=11147,localport=8000]&l;/span&g;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;注意, 该版本并不完美&l;/p&g;\n&l;ol&g;\n&l;li&g;在 Linux 环境下好像会出现路径转义错误&l;/li&g;\n&l;li&g;并不能根据请求参数的不同做出不同的响应, 只能响应最基本的请求 HTML 文件功能, 并判断是否响应 404&l;/li&g;\n&l;li&g;GET 请求的中文编码问题没解决&l;/li&g;\n&l;/ol&g;\n&l;h1 id=\&q;参考资料\&q;&g;参考资料&l;a title=\&q;#参考资料\&q; href=\&q;#参考资料\&q;&g;&l;/a&g;&l;/h1&g;\n&l;p&g;&l;a href=\&q;http://mp.weixin.qq.com/s?__biz=MzI4Njg5MDA5NA==%E2%88%A3=2247494842&a;amp;idx=2&a;amp;sn=f6741f16e652eb51ec4f25f088bec07b&a;amp;chksm=ebd4adbbdca324adaed381e1d6b0e1e4215924fffb784847a418bcfa0ace4ead05d381ef39a7&a;amp;mpshare=1&a;amp;scene=23&a;amp;srcid=1124GpVbhD0Aj7LcmrydqzqM&a;amp;sharer_sharetime=1606225397680&a;amp;sharer_shareid=ef785d0dcb6c4b3c08f0ecb4f45d01aa#rd\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;万字长文复习 HTTP&l;/a&g;&l;br&g;\n&l;a href=\&q;https://www.runoob.com/http/http-tutorial.html\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;菜鸟教程: Http &l;/a&g;&l;br&g;\n&l;a href=\&q;https://www.cnblogs.com/gxz-sw/p/6761984.html\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;HTTP 请求头和请求体&l;/a&g;&l;br&g;\n&l;a href=\&q;https://juejin.cn/post/6844903956536098823\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;java Socket + 自定义线程池 实现 web 服务器 仿 Servlet&l;/a&g;&l;br&g;\n&l;a href=\&q;https://blog.cugxuan.cn/2017/07/20/Java/java%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84http%E6%9C%8D%E5%8A%A1%E5%99%A8/\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;java 实现简单的 http 服务器&l;/a&g;&l;br&g;\n&l;a href=\&q;https://www.liaoxuefeng.com/wiki/1252599548343744/1305207629676577\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;廖雪峰-Java 网络编程&l;/a&g;&l;/p&g;\n&l;div&g;&l;h1 id=\&q;推荐文章\&q;&g;推荐文章&l;a title=\&q;#推荐文章\&q; href=\&q;%e6%8e%a8%e8%8d%90%e6%96%87%e7%ab%a0\&q;&g;&l;/a&g;&l;/h1&g;&l;ul&g;&l;li&g;&l;a href=\&q;https://mvbbb.github.io/rptlxk/\&q;&g;计算机网络学习总结[转载][2]&l;/a&g;&l;/li&g;&l;li&g;&l;a href=\&q;https://mvbbb.github.io/hf30zm/\&q;&g;计算机网络学习总结[转载][1]&l;/a&g;&l;/li&g;&l;li&g;&l;a href=\&q;https://mvbbb.github.io/hy5u9w/\&q;&g;JDBC与mysql数据库交互&l;/a&g;&l;/li&g;&l;li&g;&l;a href=\&q;https://mvbbb.github.io/sn0gdd/\&q;&g;《码出高效》笔记&l;/a&g;&l;/li&g;&l;li&g;&l;a href=\&q;https://kevin1061517.github.io/blog/posts/Java/8f30/\&q;&g;Practical Java筆記&l;/a&g;&l;/li&g;&l;/ul&g;&l;/div&g;&q;,&q;prev&q;:{&q;title&q;:&q;20/12/1 近期规划&q;,&q;link&q;:&q;izwdvz&q;},&q;next&q;:{&q;title&q;:&q;在服务器上部署运行Socket&q;,&q;link&q;:&q;bvgh8x&q;},&q;plink&q;:&q;https://mvbbb.github.io/cxnppw/&q;,&q;toc&q;:[{&q;id&q;:&q;预备知识&q;,&q;title&q;:&q;预备知识&q;,&q;index&q;:&q;1&q;,&q;children&q;:[{&q;id&q;:&q;socket-的基本使用&q;,&q;title&q;:&q;Socket 的基本使用&q;,&q;index&q;:&q;1.1&q;},{&q;id&q;:&q;http-协议&q;,&q;title&q;:&q;HTTP 协议&q;,&q;index&q;:&q;1.2&q;},{&q;id&q;:&q;java-知识&q;,&q;title&q;:&q;Java 知识&q;,&q;index&q;:&q;1.3&q;}]},{&q;id&q;:&q;实现思路&q;,&q;title&q;:&q;实现思路&q;,&q;index&q;:&q;2&q;},{&q;id&q;:&q;代码实现&q;,&q;title&q;:&q;代码实现&q;,&q;index&q;:&q;3&q;,&q;children&q;:[{&q;id&q;:&q;第一个版本&q;,&q;title&q;:&q;第一个版本&q;,&q;index&q;:&q;3.1&q;},{&q;id&q;:&q;第二个版本&q;,&q;title&q;:&q;第二个版本&q;,&q;index&q;:&q;3.2&q;}]},{&q;id&q;:&q;参考资料&q;,&q;title&q;:&q;参考资料&q;,&q;index&q;:&q;4&q;},{&q;id&q;:&q;推荐文章&q;,&q;title&q;:&q;推荐文章&q;,&q;index&q;:&q;5&q;}],&q;copyright&q;:{&q;author&q;:&q;Mvbbb&q;,&q;link&q;:&q;&l;a href=\&q;https://mvbbb.github.io/cxnppw/\&q; title=\&q;使用 Java 实现简单的 WebServer\&q;&g;https://mvbbb.github.io/cxnppw/&l;/a&g;&q;,&q;license&q;:&q;Attribution-NonCommercial-NoDerivatives 4.0 International (&l;a href=\&q;https://creativecommons.org/licenses/by-nc-sa/4.0/\&q; rel=\&q;external nofollow noopener\&q; target=\&q;_blank\&q;&g;CC BY-NC-ND 4.0&l;/a&g;)&q;}}}</script></head><body lang="en"><div style="display:none"><script type="text/javascript" src="https://s9.cnzz.com/z_stat.php?id=1279526637&amp;web_id=1279526637"></script></div>
<!-- hexo injector head_end start --><link href="//fonts.googleapis.com/css?family=Baloo+Bhaijaan|Inconsolata|Josefin+Sans|Montserrat" rel="stylesheet"><link href="/styles.43478ea7e28ed563c48b.css" rel="stylesheet">
<script src="/config.f667b9e14173c512056d.js"></script>

<link rel="stylesheet" href="/theme.6191587147d30da44d8f.css" is="theme">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0">
<!-- hexo injector body_begin start --><is-a class="φbm φk" ng-version="10.0.11"><is-l class="φeb φh"><div class="φel"><section class="φem"><header class="φec φf"><!----><is-c class="φed"><img draggable="false" class="φbw φw" src="images/avatar.jpg" alt="" title="" width="160" height="160"></is-c><!----><a href="" class="φef φa φu">Mvbbb</a><p class="φee">Who i am,who u are</p></header><div class="φeq φf"><a routerlink="/archives" class="φer φu" href="/archives"><span class="φd">45</span><span>Archives</span></a><a class="φer φu" href="/categories/Java"><span class="φd">14</span><span>Categories</span></a><!----><a routerlink="/tags" class="φer φu" href="/tags"><span class="φd">34</span><span>Tags</span></a><!----></div><!----><nav class="φen"><a class="φeo φbd φj φc φu φo" href="/">Home</a><!----><!----><!----><a class="φeo φbd φj φc φu φo" href="/about">About</a><!----><!----><!----><a class="φeo φbd φj φc φu φo" href="/search">Search</a><!----><!----><!----><!----><a target="_blank" rel="external nofollow noopener" class="φeo φbd φj φc φu φo" href="https://www.yuque.com/u1296515/zb4bwb">Yuque</a><!----><!----><!----></nav><!----><!----></section><footer class="φeg φeh"><div class="φej"><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-email" href="mailto:3212618781@qq.com">email</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-feed" href="https://mvbbb.github.io/rss2.xml">feed</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-github" href="https://github.com/Mvbbb">github</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-myspace" href="/links">myspace</a><!----></div><!----><p class="φbk φz">© 2019-2021 ❤ <a href="https://github.com/Mvbbb">Mvbbb</a></p><!----><!----><!----></footer></div></is-l><div class="φbo"><div class="φbn"><div class="φbs φbe"><main class="φbr φbf"><router-outlet></router-outlet><is-s class="φfx φf"><header class="φgh φgi" style="background-image:;background-color:;"><div class="φgq"><h1 class="φgt">使用 Java 实现简单的 WebServer</h1><!----><p class="φgj φr"><span class="φgk φgo">Nov 24, 2020</span><a class="φgk φgm φu" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C">计算机网络</a><!----><!----><!----></p><!----><!----></div></header><article itemscope="" itemtype="http://schema.org/Article" class="φga" data-title="使用 Java 实现简单的 WebServer"><div itemprop="articleBody" issnippet="" iszoomable="" class="φbk φh φz"><p><strong>Web Server 的功能: 根据用户提供的 Http request, Web Server 返回对应的 Http response. Web Server 也只不过是一个 Application.</strong></p>
<a id="more"></a>
<h1 id="预备知识">预备知识<a title="#预备知识" href="#预备知识"></a></h1>
<ul>
<li>socket 的基本使用</li>
<li>HTTP 协议</li>
<li>Java 知识</li>
</ul>
<h2 id="socket-的基本使用">Socket 的基本使用<a title="#socket-的基本使用" href="#socket-的基本使用"></a></h2>
<p>Socekt 是同一台主机内, 应用层与传输层之间的<strong>接口</strong>. 两个程序通过彼此的 Socket 接口进行信息交换, 建立在 Socket 上的程序不需要关心底层的实现.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Socket 方法</span><br><span class="line"><span class="function">InetAddress <span class="title">getInetAddress</span><span class="params">()</span> : 返回socket连接的地址</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getPort</span><span class="params">()</span>: 返回远程连接这socket的端口</span></span><br><span class="line"><span class="function">InetAddress <span class="title">getLocalAddress</span><span class="params">()</span>: 获取该socket绑定的本地地址</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getLocalPort</span><span class="params">()</span> : 获取这socket绑定的本地端口</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="http-协议">HTTP 协议<a title="#http-协议" href="#http-协议"></a></h2>
<p>HTTP 是一个基于 TCP/IP 通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）, 是客户端和服务器交互的一种通迅的格式.<br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606271561591-3af625f9-855a-4fd8-839b-1c451ae0f0ea.png#align=left&amp;display=inline&amp;height=576&amp;margin=%5Bobject%20Object%5D&amp;name=1524291150623-eb2eb938-d4b8-41e1-a848-6567cb70cbb1.png&amp;originHeight=576&amp;originWidth=1184&amp;size=289776&amp;status=done&amp;style=none&amp;width=1184" alt="1524291150623-eb2eb938-d4b8-41e1-a848-6567cb70cbb1.png"><br>
<strong>Http 请求</strong><br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606272412562-583dccd8-43a3-4215-914e-09d5841d89e3.png#align=left&amp;display=inline&amp;height=219&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=438&amp;originWidth=1448&amp;size=80530&amp;status=done&amp;style=none&amp;width=724" alt="image.png"><br>
<strong>Http 响应</strong><br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606272511628-42ec0e43-29d7-4631-bad9-75e6e6c4973f.png#align=left&amp;display=inline&amp;height=95&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=189&amp;originWidth=1457&amp;size=20968&amp;status=done&amp;style=none&amp;width=728.5" alt="image.png"><br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606272567823-60950fa0-18da-4a1b-ac1d-702a5f7daaed.png#align=left&amp;display=inline&amp;height=350&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=700&amp;originWidth=1440&amp;size=100714&amp;status=done&amp;style=none&amp;width=720" alt="image.png"><br>
首先, 用户浏览器向服务器发送 HTTP 请求来获取资源. 之后服务器回复 HTTP 响应. 在本程序中, HTTP 请求有浏览器发出, Java 程序负责响应用户请求, 并返回 HTTP 响应报文. 它们通过 Socket 接口进行 HTTP 报文交换.</p>
<h2 id="java-知识">Java 知识<a title="#java-知识" href="#java-知识"></a></h2>
<p>使用到 Java 中的两个主要类来实现 Web Server: java.net.ServerSocket, java.net.ServerSocket<br>
下图是 TCP 中客户套接字和服务器套接字的连接方式<br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606226153626-3a9197cc-b9ff-4e13-bd20-82dee4f0e140.png#align=left&amp;display=inline&amp;height=295&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=589&amp;originWidth=1094&amp;size=100586&amp;status=done&amp;style=none&amp;width=547" alt="image.png"><br>
ServerSocket 对应上图中的 Welcoming Socket, Socket 对应上图中的 Connection Socket.<br>
Welcoming Socket 监听请求, 当收到来自用户的请求, 就为其建立一个 Connection Socket.</p>
<h1 id="实现思路">实现思路<a title="#实现思路" href="#实现思路"></a></h1>
<ol>
<li>服务在指定端口进行监听，等待请求。</li>
<li>当接收到请求后，建立连接，新建一个线程，准备分析报文。</li>
<li>分析请求报文，对用户请求的网页进行查找，并读取内容。</li>
<li>构造响应报文的内容。</li>
<li>将响应报文发送给请求方。</li>
</ol>
<h1 id="代码实现">代码实现<a title="#代码实现" href="#代码实现"></a></h1>
<h2 id="第一个版本">第一个版本<a title="#第一个版本" href="#第一个版本"></a></h2>
<p>根据 HTTP 报文请求的 URL 返回给用户对应的资源.<br>
代码实现和项目目录结构如下<br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606274244639-8bcc8df0-5137-48ec-85a7-fd4025cffc8b.png#align=left&amp;display=inline&amp;height=64&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=128&amp;originWidth=481&amp;size=7262&amp;status=done&amp;style=none&amp;width=240.5" alt="image.png"></p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpServer</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String webroot= <span class="string">"version1/WebRoot/"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="comment">/*在80端口监听的 Welcoming Socekt*/</span></span><br><span class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">80</span>);</span><br><span class="line">        <span class="comment">/* accept 是一个阻塞方法, 会一直监听, 建立连接之后返回一个 Connection Socket */</span></span><br><span class="line">        System.out.println(<span class="string">"服务器端等待请求"</span>);</span><br><span class="line">        Socket socket = serverSocket.accept();</span><br><span class="line">        System.out.println(<span class="string">"成功建立连接"</span>+socket.toString());</span><br><span class="line">        <span class="comment">/*用于获取 socket 接收的服务端请求报文*/</span></span><br><span class="line">        BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(socket.getInputStream()));</span><br><span class="line">        <span class="comment">/*Http请求行*/</span></span><br><span class="line">        String httpRequestLine = reader.readLine();</span><br><span class="line">        <span class="comment">/*请求的 uri*/</span></span><br><span class="line">        String uri = httpRequestLine.split(<span class="string">" "</span>)[<span class="number">1</span>];</span><br><span class="line">        String url=webroot+uri;</span><br><span class="line">        <span class="comment">/*从磁盘中取出用户请求的资源文件, 并放回给用户*/</span></span><br><span class="line">        FileInputStream fileInputStream = <span class="keyword">new</span> FileInputStream(url);</span><br><span class="line">        OutputStream outputStream = socket.getOutputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> length=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((length=fileInputStream.read(buffer))!=-<span class="number">1</span>){</span><br><span class="line">            outputStream.write(buffer, <span class="number">0</span>, length);</span><br><span class="line">        }</span><br><span class="line">        System.out.println(<span class="string">"成功发送给用户"</span>);</span><br><span class="line">        outputStream.flush();</span><br><span class="line">        socket.close();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606274263910-c5d61a1a-47da-45ea-b722-2d7d33f34bad.png#align=left&amp;display=inline&amp;height=88&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=176&amp;originWidth=1805&amp;size=27703&amp;status=done&amp;style=none&amp;width=902.5" alt="image.png"><br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606274276825-2a66e075-e90c-4ced-a29f-721513035603.png#align=left&amp;display=inline&amp;height=107&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=214&amp;originWidth=1636&amp;size=14089&amp;status=done&amp;style=none&amp;width=818" alt="image.png"></p>
<h2 id="第二个版本">第二个版本<a title="#第二个版本" href="#第二个版本"></a></h2>
<p>1 . 在第一个版本中假如用户请求一个服务器没有的资源, 服务器会报异常, 这一点需要改进. 资源不存在的时候应该返回 404 界面<br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606274568269-7c83b37a-2166-4d1d-adf1-21bdefe42168.png#align=left&amp;display=inline&amp;height=112&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=223&amp;originWidth=1705&amp;size=53527&amp;status=done&amp;style=none&amp;width=852.5" alt="image.png"><br>
2 . 用户可能不止一次的请求服务器, 我们需要使用循环, 不断监听用户请求.<br>
3 . 真实情况下, 服务器不止处理一个用户的请求, 在第一个版本中我们只能处理一个用户的请求, 因此我们需要使用多线程, 同时处理多个用户的请求.<br>
4 . 实现 GET/POST, 并返回标准的 HTTP response</p>
<p>代码实现和目录结构如下<br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606395502266-9889c3a9-7fd2-4532-840e-ee20a6f69f37.png#align=left&amp;display=inline&amp;height=74&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=148&amp;originWidth=358&amp;size=8216&amp;status=done&amp;style=none&amp;width=179" alt="image.png"><br>
代码仓库 <a href="https://github.com/Mvbbb/small-java-demo/blob/master/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/WebServer.java" target="_blank" rel="external nofollow noopener">HTTP 服务器</a></p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebServer</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>{</span><br><span class="line">        ServerSocket serverSocket=<span class="keyword">new</span> ServerSocket(<span class="number">8000</span>);</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>){</span><br><span class="line">            Socket socket= serverSocket.accept();</span><br><span class="line">            <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyHttpServer(socket)).start();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理一个 Connection Socket 的请求的 HttpServer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHttpServer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String CRLF=<span class="string">"\r\n"</span>;</span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="keyword">private</span> String webroot;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyHttpServer</span><span class="params">(Socket socket)</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"连接到服务器的用户: "</span>+socket);</span><br><span class="line">        <span class="keyword">this</span>.socket = socket;</span><br><span class="line">        <span class="comment">// 服务器的资源根目录是当前用户的工作目录</span></span><br><span class="line">        webroot=System.getProperties().getProperty(<span class="string">"user.dir"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 目前只是实现了解析 HTTP 请求</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">        BufferedReader reader=<span class="keyword">null</span>;</span><br><span class="line">        PrintWriter printWriter=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="comment">// 读取输入</span></span><br><span class="line">            reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(socket.getInputStream()));</span><br><span class="line">            <span class="comment">// 写输出</span></span><br><span class="line">            printWriter = <span class="keyword">new</span> PrintWriter(socket.getOutputStream(), <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 读入请求行</span></span><br><span class="line">            String requestLine = reader.readLine();</span><br><span class="line">            <span class="keyword">if</span>(requestLine==<span class="keyword">null</span>)<span class="keyword">return</span>;</span><br><span class="line">            <span class="comment">// 请求行参数: POST/GET 请求uri HTTP版本</span></span><br><span class="line">            String[] requstLineArgs = requestLine.split(<span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 读入请求头</span></span><br><span class="line">            String line = <span class="keyword">null</span>;</span><br><span class="line">            String[] keyValue = <span class="keyword">null</span>;</span><br><span class="line">            Map&lt;String, String&gt; requestHeaders = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(line)) {</span><br><span class="line">                <span class="keyword">int</span> i = line.indexOf(<span class="string">": "</span>);</span><br><span class="line">                requestHeaders.put(line.substring(<span class="number">0</span>,i),line.substring(i+<span class="number">2</span>));</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">// 展示HTTP请求行中的参数</span></span><br><span class="line">            System.out.println(<span class="string">"用户"</span>+socket.getPort()+<span class="string">"请求方法: "</span>+requstLineArgs[<span class="number">0</span>]);</span><br><span class="line">            System.out.println(<span class="string">"用户"</span>+socket.getPort()+<span class="string">"请求地址: "</span>+requstLineArgs[<span class="number">1</span>]);</span><br><span class="line">            System.out.println(<span class="string">"用户"</span>+socket.getPort()+<span class="string">"的HTTP版本: "</span>+requstLineArgs[<span class="number">2</span>]);</span><br><span class="line">            <span class="comment">// 展示Http 请求头中的参数</span></span><br><span class="line">            System.out.println(<span class="string">"********************"</span>);</span><br><span class="line">            System.out.println(<span class="string">"用户"</span>+socket.getPort()+<span class="string">"请求头参数"</span>);</span><br><span class="line">            showMapValue(requestHeaders);</span><br><span class="line">            System.out.println(<span class="string">"********************"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果是POST方法继续读入请求体</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="string">"POST"</span>.equals(requstLineArgs[<span class="number">0</span>])) {</span><br><span class="line">                doPost(requstLineArgs, requestHeaders, reader, printWriter);</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">// 如果是GET方法就解析uri</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="string">"GET"</span>.equals(requstLineArgs[<span class="number">0</span>])) {</span><br><span class="line">                doGet(requstLineArgs, requestHeaders, printWriter);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        } <span class="keyword">finally</span> {</span><br><span class="line">            <span class="keyword">if</span> (reader != <span class="keyword">null</span>) {</span><br><span class="line">                <span class="keyword">try</span> {</span><br><span class="line">                    reader.close();</span><br><span class="line">                } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span> (printWriter != <span class="keyword">null</span>) {</span><br><span class="line">                printWriter.close();</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(socket!=<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">try</span> {</span><br><span class="line">                    System.out.println(<span class="string">"关闭与服务器连接的用户: "</span>+socket);</span><br><span class="line">                    System.out.println();</span><br><span class="line">                    socket.close();</span><br><span class="line">                } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 请求行中是 GET 方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestLineArgs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestHeaders</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> printWriter</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(String[] requestLineArgs,Map&lt;String,String&gt; requestHeaders,PrintWriter printWriter)</span></span>{</span><br><span class="line">        <span class="comment">// GET 的 requestLine 的解析</span></span><br><span class="line">        <span class="keyword">int</span> i = requestLineArgs[<span class="number">1</span>].indexOf(<span class="string">'?'</span>);</span><br><span class="line">        <span class="comment">// GET 有参数</span></span><br><span class="line">        <span class="keyword">if</span>(i!=-<span class="number">1</span>) {</span><br><span class="line">            <span class="comment">// 将参数放入到 getArgs 中</span></span><br><span class="line">            String sourceUri = requestLineArgs[<span class="number">1</span>].substring(<span class="number">0</span>, i);</span><br><span class="line">            String[] s = requestLineArgs[<span class="number">1</span>].substring(i + <span class="number">1</span>).split(<span class="string">"&amp;"</span>);</span><br><span class="line">            String[] keyValue = <span class="keyword">null</span>;</span><br><span class="line">            Map&lt;String, String&gt; getArgs = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">            <span class="keyword">for</span> (String ss : s) {</span><br><span class="line">                String[] split = ss.split(<span class="string">"="</span>);</span><br><span class="line">                getArgs.put(split[<span class="number">0</span>], split[<span class="number">1</span>]);</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">// 展示GET请求链接中的参数</span></span><br><span class="line">            System.out.println(<span class="string">"********************"</span>);</span><br><span class="line">            System.out.println(<span class="string">"用户"</span>+socket.getPort()+<span class="string">"GET 中的参数"</span>);</span><br><span class="line">            showMapValue(getArgs);</span><br><span class="line">            System.out.println(<span class="string">"********************"</span>);</span><br><span class="line"></span><br><span class="line">            writeFile(printWriter,requestHeaders,sourceUri);</span><br><span class="line">        }<span class="keyword">else</span>{ <span class="comment">// 没有额外参数, 属于直接访问</span></span><br><span class="line">            writeFile(printWriter,requestHeaders,requestLineArgs[<span class="number">1</span>]);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 请求行中是 POST 方法, 现在还不会处理POST方法, 先挖坑</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestLineArgs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestHeaders</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> reader</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> printWriter</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(String[] requestLineArgs,Map&lt;String,String&gt; requestHeaders,BufferedReader reader,PrintWriter printWriter)</span></span>{</span><br><span class="line">        String sourceUri=requestLineArgs[<span class="number">1</span>];</span><br><span class="line">        <span class="comment">// 还需要读入 requestBody</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将用户请求的文件发送给用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> printWriter</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestHeaders</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uri</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(PrintWriter printWriter,Map&lt;String,String&gt; requestHeaders,String uri)</span> </span>{</span><br><span class="line">        String url=webroot+uri;</span><br><span class="line">        System.out.println(<span class="string">"用户"</span>+socket.getPort()+<span class="string">"请求文件地址: "</span>+url);</span><br><span class="line">        File file = <span class="keyword">new</span> File(url);</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            String statusLine=<span class="keyword">null</span>;</span><br><span class="line">            String contentType=<span class="keyword">null</span>;</span><br><span class="line">            String entityBody=<span class="keyword">null</span>;</span><br><span class="line">            <span class="comment">// 请求的文件存在</span></span><br><span class="line">             <span class="keyword">if</span>(file.exists()&amp;&amp;file.isFile()){</span><br><span class="line">                statusLine =<span class="string">"HTTP/1.0 200 OK"</span>+CRLF;</span><br><span class="line">                contentType=<span class="string">"Content-Type"</span>  +contentType(file.toString())+CRLF;</span><br><span class="line">                printWriter.print(statusLine);</span><br><span class="line">                printWriter.print(contentType);</span><br><span class="line">                printWriter.print(CRLF); <span class="comment">//之前的为响应行+响应头部, 之后的是响应正文, 之间用 CRLF 分隔</span></span><br><span class="line">                 <span class="comment">// 将文件内容发送给用户</span></span><br><span class="line">                 Scanner scanner = <span class="keyword">new</span> Scanner(<span class="keyword">new</span> FileInputStream(file));</span><br><span class="line">                 <span class="keyword">while</span> (scanner.hasNextLine()) {</span><br><span class="line">                     printWriter.println(scanner.nextLine());</span><br><span class="line">                 }</span><br><span class="line">                 printWriter.flush();</span><br><span class="line">             }</span><br><span class="line">            <span class="keyword">else</span>{</span><br><span class="line">                statusLine=<span class="string">"HTTP/1.0 404 Not Found"</span>+CRLF;</span><br><span class="line">                contentType=<span class="string">"Content-Type: text/html"</span>+CRLF;</span><br><span class="line">                entityBody=<span class="string">"&lt;HTML&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;HEAD&gt;&lt;TITLE&gt;Not Found&lt;/TITLE&gt;&lt;/HEAD&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;BODY&gt;Not Found&lt;/BODY&gt;&lt;/HTML&gt;"</span>;</span><br><span class="line">                 printWriter.print(statusLine);</span><br><span class="line">                 printWriter.print(contentType);</span><br><span class="line">                 printWriter.print(CRLF); <span class="comment">//之前的为响应行+响应头部, 之后的是响应正文, 之间用 CRLF 分隔</span></span><br><span class="line">                 printWriter.print(entityBody);</span><br><span class="line">                 printWriter.flush();</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        }<span class="keyword">catch</span> (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户请求的文件类型, 返回符合mime标准的文件类型</span></span><br><span class="line"><span class="comment">     * 目前只实现了请求html文件的功能</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">contentType</span><span class="params">(String fileName)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(fileName.endsWith(<span class="string">".htm"</span>)||fileName.endsWith(<span class="string">".html"</span>)){</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"text/html"</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMapValue</span><span class="params">(Map&lt;String,String&gt; map)</span></span>{</span><br><span class="line">        Set&lt;Map.Entry&lt;String, String&gt;&gt; entries = map.entrySet();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : entries) {</span><br><span class="line">            System.out.println(entry.getKey()+<span class="string">": "</span>+entry.getValue());</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1606397469282-42f17800-1e86-4341-9542-b2acab5f250e.png#align=left&amp;display=inline&amp;height=515&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=1030&amp;originWidth=1920&amp;size=68141&amp;status=done&amp;style=none&amp;width=960" alt="image.png"><br>
控制台打印</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">连接到服务器的用户: Socket[addr=/<span class="number">0</span>:<span class="number">0</span>:<span class="number">0</span>:<span class="number">0</span>:<span class="number">0</span>:<span class="number">0</span>:<span class="number">0</span>:<span class="number">1</span>,port=<span class="number">11148</span>,localport=<span class="number">8000</span>]</span><br><span class="line">用户<span class="number">11147</span>请求方法: GET</span><br><span class="line">用户<span class="number">11147</span>请求地址: /index.html</span><br><span class="line">用户<span class="number">11147</span>的HTTP版本: HTTP/<span class="number">1.1</span></span><br><span class="line">********************</span><br><span class="line">用户<span class="number">11147</span>请求头参数</span><br><span class="line">Cookie: Idea-48934e7a=d9468800-fffb-4bce-<span class="number">8707</span>-98eda7648a0b; Webstorm-bee48fc1=<span class="number">645e8992</span>-2d9b-<span class="number">4176</span>-af5d-21b7e87ac442</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="comment">Connection: keep-alive</span></span><br><span class="line"><span class="comment">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36</span></span><br><span class="line"><span class="comment">Sec-Fetch-Site: none</span></span><br><span class="line"><span class="comment">Sec-Fetch-Dest: document</span></span><br><span class="line"><span class="comment">Host: localhost:8000</span></span><br><span class="line"><span class="comment">Sec-Fetch-User: ?1</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate, br</span></span><br><span class="line"><span class="comment">Accept-Language: zh,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7</span></span><br><span class="line"><span class="comment">Sec-Fetch-Mode: navigate</span></span><br><span class="line"><span class="comment">********************</span></span><br><span class="line"><span class="comment">用户11147请求文件地址: E:\Desktop\新建文件夹 (2)/index.html</span></span><br><span class="line"><span class="comment">关闭与服务器连接的用户: Socket[addr=/0:0:0:0:0:0:0:1,port=11147,localport=8000]</span></span><br></pre></td></tr></tbody></table></figure>
<p>注意, 该版本并不完美</p>
<ol>
<li>在 Linux 环境下好像会出现路径转义错误</li>
<li>并不能根据请求参数的不同做出不同的响应, 只能响应最基本的请求 HTML 文件功能, 并判断是否响应 404</li>
<li>GET 请求的中文编码问题没解决</li>
</ol>
<h1 id="参考资料">参考资料<a title="#参考资料" href="#参考资料"></a></h1>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzI4Njg5MDA5NA==%E2%88%A3=2247494842&amp;idx=2&amp;sn=f6741f16e652eb51ec4f25f088bec07b&amp;chksm=ebd4adbbdca324adaed381e1d6b0e1e4215924fffb784847a418bcfa0ace4ead05d381ef39a7&amp;mpshare=1&amp;scene=23&amp;srcid=1124GpVbhD0Aj7LcmrydqzqM&amp;sharer_sharetime=1606225397680&amp;sharer_shareid=ef785d0dcb6c4b3c08f0ecb4f45d01aa#rd" target="_blank" rel="external nofollow noopener">万字长文复习 HTTP</a><br>
<a href="https://www.runoob.com/http/http-tutorial.html" target="_blank" rel="external nofollow noopener">菜鸟教程: Http </a><br>
<a href="https://www.cnblogs.com/gxz-sw/p/6761984.html" target="_blank" rel="external nofollow noopener">HTTP 请求头和请求体</a><br>
<a href="https://juejin.cn/post/6844903956536098823" target="_blank" rel="external nofollow noopener">java Socket + 自定义线程池 实现 web 服务器 仿 Servlet</a><br>
<a href="https://blog.cugxuan.cn/2017/07/20/Java/java%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84http%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="external nofollow noopener">java 实现简单的 http 服务器</a><br>
<a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1305207629676577" target="_blank" rel="external nofollow noopener">廖雪峰-Java 网络编程</a></p>
<div><h1 id="推荐文章">推荐文章<a title="#推荐文章" href="%e6%8e%a8%e8%8d%90%e6%96%87%e7%ab%a0"></a></h1><ul><li><a href="https://mvbbb.github.io/rptlxk/">计算机网络学习总结[转载][2]</a></li><li><a href="https://mvbbb.github.io/hf30zm/">计算机网络学习总结[转载][1]</a></li><li><a href="https://mvbbb.github.io/hy5u9w/">JDBC与mysql数据库交互</a></li><li><a href="https://mvbbb.github.io/sn0gdd/">《码出高效》笔记</a></li><li><a href="https://kevin1061517.github.io/blog/posts/Java/8f30/">Practical Java筆記</a></li></ul></div></div><is-f class="φcc φv φs"><!----><ul class="φcg"><li class="φce"><strong class="φcf">Author<span>:</span></strong><p class="φcd">Mvbbb</p></li><li class="φce"><strong class="φcf">Link<span>:</span></strong><p class="φcd"><a href="https://mvbbb.github.io/cxnppw/" title="使用 Java 实现简单的 WebServer">https://mvbbb.github.io/cxnppw/</a></p></li><li class="φce"><strong class="φcf">Copyright<span>:</span></strong><p class="φcd">Attribution-NonCommercial-NoDerivatives 4.0 International (<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener" target="_blank">CC BY-NC-ND 4.0</a>)</p></li><!----></ul><!----></is-f><!----><!----><!----></article><footer class="φgb φh"><div class="φgg"><is-m class="φet"><a class="φeu φs φq" href="/tags/Http">Http</a></is-m><is-m class="φet"><a class="φeu φs φq" href="/tags/Java">Java</a></is-m><is-m class="φet"><a class="φeu φs φq" href="/tags/NetWork">NetWork</a></is-m><is-m class="φet"><a class="φeu φs φq" href="/tags/Socket">Socket</a></is-m><!----></div><!----><div class="φgc"><a class="φgd φgf φu" href="/izwdvz">20/12/1 近期规划</a><!----><a class="φgd φge φu" href="/bvgh8x">在服务器上部署运行Socket</a><!----></div><!----></footer><is-e class="φbz φh"><div issnippet="" class="φbh"><div id="tcomment"></div>


</div><!----><!----><!----><!----></is-e><!----><!----><!----></is-s><!----></main><!----></div></div></div><is-g class="φch"><div class="φcq"><span class="φbg icon-up"></span><span class="φbg icon-down"></span><!----><span class="φbg icon-toc"></span><!----><span class="φbg icon-search"></span><!----></div><div class="φcj φck"><svg class="φcp"><defs><filter id="dp"><feGaussianBlur in="SourceGraphic" stdDeviation="2"></feGaussianBlur></filter></defs><circle filter="url(#dp)" fill="rgba(0,0,0,.3)" cx="50%" cy="52%" r="44%"></circle><circle cx="50%" cy="50%" r="44%" class="φcl φbb"></circle><circle cx="50%" cy="50%" r="48%" class="φco φba" stroke-dasharray="0% 314.15926%"></circle><!----><g class="φcm"><circle r=".2rem" cx="0" cy="-.8rem"></circle><circle r=".2rem"></circle><circle r=".2rem" cx="0" cy=".8rem"></circle></g><!----></svg></div></is-g><is-n class="φev φf"><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">1 </span><!----><span class="φfc">预备知识</span></a><div class="φex"><a class="φfa φu"><span class="φfb φd">1.1 </span><!----><span class="φfc">Socket 的基本使用</span></a><!----></div><div class="φex"><a class="φfa φu"><span class="φfb φd">1.2 </span><!----><span class="φfc">HTTP 协议</span></a><!----></div><div class="φex"><a class="φfa φu"><span class="φfb φd">1.3 </span><!----><span class="φfc">Java 知识</span></a><!----></div><!----><!----><!----></div><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">2 </span><!----><span class="φfc">实现思路</span></a><!----></div><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">3 </span><!----><span class="φfc">代码实现</span></a><div class="φex"><a class="φfa φu"><span class="φfb φd">3.1 </span><!----><span class="φfc">第一个版本</span></a><!----></div><div class="φex"><a class="φfa φu"><span class="φfb φd">3.2 </span><!----><span class="φfc">第二个版本</span></a><!----></div><!----><!----><!----></div><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">4 </span><!----><span class="φfc">参考资料</span></a><!----></div><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">5 </span><!----><span class="φfc">推荐文章</span></a><!----></div><!----></is-n><!----><!----></is-a><!-- hexo injector body_begin end --><!-- hexo injector body_end start --><script src="https://cdn.jsdelivr.net/npm/twikoo@1.0.0/dist/twikoo.all.min.js"></script><script src="/runtime.b15aa7186c559b492b7d.js"></script><script src="/polyfills.824ff89b5f3ca4543a31.js"></script><script src="/main.03652fc423a687c817e8.js"></script><!-- hexo injector body_end end -->

</body></html>