<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8">
<meta name="referrer" content="no-referrer">
<title>Linux服务器安装 MySql 8.0并配置远程连接 - Yu</title>
<base href="/">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<link rel="canonical" href="https://mvbbb.github.io/sb74kg/">
<link rel="icon" type="image/x-icon" href="/images/web.png">

<meta name="description" content="配置了一个下午, 终于配置成功了, 决定把今天遇到的坑都写下来">
<meta property="og:type" content="website">
<meta property="og:title" content="Linux服务器安装 MySql 8.0并配置远程连接">
<meta property="og:url" content="https://mvbbb.github.io/sb74kg/index.html">
<meta property="og:site_name" content="Yu">
<meta property="og:description" content="配置了一个下午, 终于配置成功了, 决定把今天遇到的坑都写下来">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://mvbbb.github.io/sb74kg/images/avatar.jpg">
<meta property="article:published_time" content="2020-11-05T13:04:14.000Z">
<meta property="article:modified_time" content="2021-02-03T04:20:59.377Z">
<meta property="article:author" content="Mvbbb">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mvbbb.github.io/sb74kg/images/avatar.jpg">
<script type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","publisher":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"url":"https://mvbbb.github.io","image":"https://mvbbb.github.io/images/avatar.jpg","description":"Who i am,who u are","author":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"inLanguage":{"@type":"Language","alternateName":"en"}},{"@context":"http://schema.org","@type":"Article","articleSection":"教程与记录","url":"https://mvbbb.github.io/sb74kg/","headline":"Linux服务器安装 MySql 8.0并配置远程连接","image":"https://mvbbb.github.io/images/avatar.jpg","datePublished":"2020-11-05T13:04:14.000Z","dateModified":"2021-02-03T04:20:59.377Z","keywords":"","description":"配置了一个下午, 终于配置成功了, 决定把今天遇到的坑都写下来\n","publisher":{"@type":"Organization","name":"Yu","logo":{"@type":"ImageObject","url":"https://mvbbb.github.io/images/avatar.jpg"}},"author":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"inLanguage":{"@type":"Language","alternateName":"en"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mvbbb.github.io/sb74kg/"}}]</script><link rel="alternate" type="application/atom+xml" title="Yu" href="/rss2.xml">
<script async="" src="//www.googletagmanager.com/gtag/js?id=UA-160027215-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)};gtag('js',new Date());gtag('config','UA-160027215-1');</script>
<meta name="theme-color" content=""><script type="application/json" is="state">{&q;api/c2I3NGtn.json&q;:{&q;title&q;:&q;Linux服务器安装 MySql 8.0并配置远程连接&q;,&q;date&q;:&q;2020-11-05T13:04:14.000Z&q;,&q;date_formatted&q;:{&q;ll&q;:&q;Nov 5, 2020&q;,&q;L&q;:&q;11/05/2020&q;,&q;MM-DD&q;:&q;11-05&q;},&q;link&q;:&q;sb74kg&q;,&q;comments&q;:true,&q;categories&q;:[&q;教程与记录&q;],&q;updated&q;:&q;2021-02-03T04:20:59.377Z&q;,&q;content&q;:&q;&l;p&g;配置了一个下午, 终于配置成功了, 决定把今天遇到的坑都写下来&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1604581632853-dd30b637-a843-4b71-889c-ccebea99c75c.png#align=left&a;amp;display=inline&a;amp;height=119&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=238&a;amp;originWidth=1199&a;amp;size=34794&a;amp;status=done&a;amp;style=none&a;amp;width=599.5\&q; alt=\&q;image.png\&q;&g;&l;/p&g;\n&l;a id=\&q;more\&q;&g;&l;/a&g;\n&l;h1 id=\&q;教程\&q;&g;教程&l;a title=\&q;#教程\&q; href=\&q;#教程\&q;&g;&l;/a&g;&l;/h1&g;\n&l;p&g;只针对 Mysql 8, centos7/Ubuntu20&l;br&g;\n1 . 使用宝塔面板傻瓜式安装 MySql8.0&l;br&g;\n2 . 在宝塔-安全处发行 3306 端口, 并且在服务器厂商处放行 3306 端口&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1604581656064-9c15f40e-b577-4f4c-aea8-c6db26e90fb5.png#align=left&a;amp;display=inline&a;amp;height=182&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=363&a;amp;originWidth=1647&a;amp;size=36497&a;amp;status=done&a;amp;style=none&a;amp;width=823.5\&q; alt=\&q;image.png\&q;&g;&l;/p&g;\n&l;ul&g;\n&l;li&g;&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1604581684329-30e3cd82-1bdb-4275-96e2-ffe683b8506f.png#align=left&a;amp;display=inline&a;amp;height=88&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=176&a;amp;originWidth=1637&a;amp;size=21648&a;amp;status=done&a;amp;style=none&a;amp;width=818.5\&q; alt=\&q;image.png\&q; class=\&q;φcx\&q;&g;&l;/li&g;\n&l;/ul&g;\n&l;p&g;3 . 修改配置, 可以直接在宝塔 Mysql 进行配置修改, 在 [mysqld] 下面添加 &l;code&g;skip-grant-tables&l;/code&g; 跳过安全检查. 重启服务器.&l;br&g;\n4 . 在云主机提供的终端进行以下命令操作&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2020/png/1552854/1608095806879-a5b18c29-5fea-43aa-9179-26742cca7e32.png#align=left&a;amp;display=inline&a;amp;height=430&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=859&a;amp;originWidth=1466&a;amp;size=141616&a;amp;status=done&a;amp;style=none&a;amp;width=733\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n5 . 登录 Mysql , 修改 root 用户的远程访问权限并修改密码&l;/p&g;\n&l;figure class=\&q;highlight sql\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;14&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;15&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;16&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;17&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;# 输入之后直接回车, 默认没有密码&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;mysql &l;span class=\&q;operator\&q;&g;-&l;/span&g;u root&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 使用 Mysql 数据库&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;use mysql;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 查看用户访问端口. root 的host是 localhost, 只允许本地访问, 不允许远程访问, 如果没有root账户需要手动添加, 查看文末链接&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;select&l;/span&g; &l;span class=\&q;keyword\&q;&g;user&l;/span&g;,host &l;span class=\&q;keyword\&q;&g;from&l;/span&g; &l;span class=\&q;keyword\&q;&g;user&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 修改访问端口&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;update&l;/span&g; &l;span class=\&q;keyword\&q;&g;user&l;/span&g; &l;span class=\&q;keyword\&q;&g;set&l;/span&g; host &l;span class=\&q;operator\&q;&g;=&l;/span&g; &l;span class=\&q;string\&q;&g;&a;#x27;%&a;#x27;&l;/span&g; &l;span class=\&q;keyword\&q;&g;where&l;/span&g; &l;span class=\&q;keyword\&q;&g;user&l;/span&g; &l;span class=\&q;operator\&q;&g;=&l;/span&g; &l;span class=\&q;string\&q;&g;&a;#x27;root&a;#x27;&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 刷新服务配置项&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;FLUSH PRIVILEGES;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 再次查看 root 的host, 发现变成了 &l;span class=\&q;operator\&q;&g;%&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;select&l;/span&g; &l;span class=\&q;keyword\&q;&g;user&l;/span&g;,host &l;span class=\&q;keyword\&q;&g;from&l;/span&g; &l;span class=\&q;keyword\&q;&g;user&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 修改 root 用户的密码, 如果出现因为处于 &a;quot;--skip-grant-tables&a;quot; 模式而产生的限制, 先执行一次 FLUSH PRIVILEGES;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;ALTER&l;/span&g; &l;span class=\&q;keyword\&q;&g;USER&l;/span&g; &l;span class=\&q;string\&q;&g;&a;#x27;root&a;#x27;&l;/span&g;@&l;span class=\&q;string\&q;&g;&a;#x27;%&a;#x27;&l;/span&g; IDENTIFIED &l;span class=\&q;keyword\&q;&g;WITH&l;/span&g; MYSQL_NATIVE_PASSWORD &l;span class=\&q;keyword\&q;&g;BY&l;/span&g; &l;span class=\&q;string\&q;&g;&a;#x27;新密码&a;#x27;&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;# 退出, 将 &a;quot;--skip-grant-tables&a;quot; 属性注释了&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;vi &l;span class=\&q;operator\&q;&g;/&l;/span&g;etc&l;span class=\&q;operator\&q;&g;/&l;/span&g;my.cnf&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;6 . 测试新密码是否可以登录&l;/p&g;\n&l;figure class=\&q;highlight sql\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;mysql &l;span class=\&q;operator\&q;&g;-&l;/span&g;uroot &l;span class=\&q;operator\&q;&g;-&l;/span&g;p密码&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;7 . 重启 MySQL&l;/p&g;\n&l;figure class=\&q;highlight bash\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;service mysql restart&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;service&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;8 . 在本机 cmd 测试是否可以远程登录&l;/p&g;\n&l;figure class=\&q;highlight sql\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;mysql &l;span class=\&q;operator\&q;&g;-&l;/span&g;h&l;span class=\&q;operator\&q;&g;&a;lt;&l;/span&g;主机公网IP&l;span class=\&q;operator\&q;&g;&a;gt;&l;/span&g; &l;span class=\&q;operator\&q;&g;-&l;/span&g;uroot &l;span class=\&q;operator\&q;&g;-&l;/span&g;p&l;span class=\&q;operator\&q;&g;&a;lt;&l;/span&g;新密码&l;span class=\&q;operator\&q;&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;9 . 之后就可以使用远程连接工具来连接服务器了 Navicat 之类的&l;/p&g;\n&l;h1 id=\&q;坑与细节\&q;&g;坑与细节&l;a title=\&q;#坑与细节\&q; href=\&q;#坑与细节\&q;&g;&l;/a&g;&l;/h1&g;\n&l;p&g;看了别的教程, 觉得不同的 MySql 版本之间的差异还是挺大的, 许多方法在不同的 Mysql 版本中不兼容.&l;br&g;\n坑如下:&l;/p&g;\n&l;ol&g;\n&l;li&g;使用服务器终端输入 &l;code&g;mysql -u root&l;/code&g; 之后显示 &l;code&g;PermissionDenied&l;/code&g; 认证失败&l;br&g;\n解决方案: 在 &l;code&g;/etc/my.cnf&l;/code&g; 下的 [mysqld] 添加一行 &l;code&g;--skip-grant-tables&l;/code&g;&l;/li&g;\n&l;li&g;可以在服务器终端成功登录, 关闭防火墙也没用, 无法在远程登录, 执行&l;code&g;netstat -an | grep 3306&l;/code&g; 或者 &l;code&g;lsof -i :3306&l;/code&g; 没有反应, 3306 端口没有被占用&l;br&g;\n出现这个情况是因为现在 Mysql 处于 ‘skip-grant-tables’ 模式&l;/li&g;\n&l;li&g;远程连接报错 &l;code&g;ERROR 2003 (HY000): Can&s;t connect to MySQL server on&l;/code&g;&l;br&g;\n按照别的教程大多都是到配置文件注释 &l;code&g;bind-address&l;/code&g;, 但是在 mysql 8 中已经没有这个配置了. 其实主要就是 Mysql 处于 &l;code&g;--skip-grant-tables&l;/code&g; 模式, 按照上面的教程步骤来&l;/li&g;\n&l;li&g;有的教程使用 &l;code&g;UPDATE user SET Password = PASSWORD(&s;newpass&s;) WHERE user = &s;root&s;;&l;/code&g; 来更新密码, MySql 报语法错误&l;br&g;\n首先 Mysql8 的密码字段名不是 password, 而是 &l;code&g;mysql_native_password&l;/code&g; .其次不是使用的 password 函数. 更改密码的命令应该使用&l;/li&g;\n&l;/ol&g;\n&l;figure class=\&q;highlight sql\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;ALTER&l;/span&g; &l;span class=\&q;keyword\&q;&g;USER&l;/span&g; &l;span class=\&q;string\&q;&g;&a;#x27;test&a;#x27;&l;/span&g;@&l;span class=\&q;string\&q;&g;&a;#x27;localhost&a;#x27;&l;/span&g; IDENTIFIED &l;span class=\&q;keyword\&q;&g;WITH&l;/span&g; MYSQL_NATIVE_PASSWORD &l;span class=\&q;keyword\&q;&g;BY&l;/span&g; &l;span class=\&q;string\&q;&g;&a;#x27;新密码&a;#x27;&l;/span&g;;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;参考:&l;/p&g;\n&l;p&g;&l;a href=\&q;https://www.cnblogs.com/zyhcs/p/13866873.html\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;Navicat 连接远程 MySQL8.0 数据库&l;/a&g;&l;br&g;\n&l;a href=\&q;https://blog.csdn.net/weixin_43671497/article/details/84931578\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;Linux 下 mysql 服务存在，但是 3306 端口监听不存在，远程连接不上&l;/a&g;&l;br&g;\n&l;a href=\&q;https://blog.csdn.net/niuchenliang524/article/details/104607496/\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;Mysql 中 root 账户丢失&l;/a&g;&l;/p&g;\n&q;,&q;prev&q;:{&q;title&q;:&q;近期规划-碎碎念&q;,&q;link&q;:&q;gmx84f&q;},&q;next&q;:{&q;title&q;:&q;内存管理&q;,&q;link&q;:&q;ldcb18&q;},&q;plink&q;:&q;https://mvbbb.github.io/sb74kg/&q;,&q;toc&q;:[{&q;id&q;:&q;教程&q;,&q;title&q;:&q;教程&q;,&q;index&q;:&q;1&q;},{&q;id&q;:&q;坑与细节&q;,&q;title&q;:&q;坑与细节&q;,&q;index&q;:&q;2&q;}],&q;copyright&q;:{&q;author&q;:&q;Mvbbb&q;,&q;link&q;:&q;&l;a href=\&q;https://mvbbb.github.io/sb74kg/\&q; title=\&q;Linux服务器安装 MySql 8.0并配置远程连接\&q;&g;https://mvbbb.github.io/sb74kg/&l;/a&g;&q;,&q;license&q;:&q;Attribution-NonCommercial-NoDerivatives 4.0 International (&l;a href=\&q;https://creativecommons.org/licenses/by-nc-sa/4.0/\&q; rel=\&q;external nofollow noopener\&q; target=\&q;_blank\&q;&g;CC BY-NC-ND 4.0&l;/a&g;)&q;}}}</script></head><body lang="en"><div style="display:none"><script type="text/javascript" src="https://s9.cnzz.com/z_stat.php?id=1279526637&amp;web_id=1279526637"></script></div>
<!-- hexo injector head_end start --><link href="//fonts.googleapis.com/css?family=Baloo+Bhaijaan|Inconsolata|Josefin+Sans|Montserrat" rel="stylesheet"><link href="/styles.43478ea7e28ed563c48b.css" rel="stylesheet">
<script src="/config.f667b9e14173c512056d.js"></script>

<link rel="stylesheet" href="/theme.6191587147d30da44d8f.css" is="theme">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0">
<!-- hexo injector body_begin start --><is-a class="φbm φk" ng-version="10.0.11"><is-l class="φeb φh"><div class="φel"><section class="φem"><header class="φec φf"><!----><is-c class="φed"><img draggable="false" class="φbw φw" src="images/avatar.jpg" alt="" title="" width="160" height="160"></is-c><!----><a href="" class="φef φa φu">Mvbbb</a><p class="φee">Who i am,who u are</p></header><div class="φeq φf"><a routerlink="/archives" class="φer φu" href="/archives"><span class="φd">45</span><span>Archives</span></a><a class="φer φu" href="/categories/Java"><span class="φd">14</span><span>Categories</span></a><!----><a routerlink="/tags" class="φer φu" href="/tags"><span class="φd">34</span><span>Tags</span></a><!----></div><!----><nav class="φen"><a class="φeo φbd φj φc φu φo" href="/">Home</a><!----><!----><!----><a class="φeo φbd φj φc φu φo" href="/about">About</a><!----><!----><!----><a class="φeo φbd φj φc φu φo" href="/search">Search</a><!----><!----><!----><!----><a target="_blank" rel="external nofollow noopener" class="φeo φbd φj φc φu φo" href="https://www.yuque.com/u1296515/zb4bwb">Yuque</a><!----><!----><!----></nav><!----><!----></section><footer class="φeg φeh"><div class="φej"><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-email" href="mailto:3212618781@qq.com">email</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-feed" href="https://mvbbb.github.io/rss2.xml">feed</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-github" href="https://github.com/Mvbbb">github</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-myspace" href="/links">myspace</a><!----></div><!----><p class="φbk φz">© 2019-2021 ❤ <a href="https://github.com/Mvbbb">Mvbbb</a></p><!----><!----><!----></footer></div></is-l><div class="φbo"><div class="φbn"><div class="φbs φbe"><main class="φbr φbf"><router-outlet></router-outlet><is-s class="φfx φf"><header class="φgh φgi" style="background-image:;background-color:;"><div class="φgq"><h1 class="φgt">Linux服务器安装 MySql 8.0并配置远程连接</h1><!----><p class="φgj φr"><span class="φgk φgo">Nov 5, 2020</span><a class="φgk φgm φu" href="/categories/%E6%95%99%E7%A8%8B%E4%B8%8E%E8%AE%B0%E5%BD%95">教程与记录</a><!----><!----><!----></p><!----><!----></div></header><article itemscope="" itemtype="http://schema.org/Article" class="φga" data-title="Linux服务器安装 MySql 8.0并配置远程连接"><div itemprop="articleBody" issnippet="" iszoomable="" class="φbk φh φz"><p>配置了一个下午, 终于配置成功了, 决定把今天遇到的坑都写下来<br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1604581632853-dd30b637-a843-4b71-889c-ccebea99c75c.png#align=left&amp;display=inline&amp;height=119&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=238&amp;originWidth=1199&amp;size=34794&amp;status=done&amp;style=none&amp;width=599.5" alt="image.png"></p>
<a id="more"></a>
<h1 id="教程">教程<a title="#教程" href="#教程"></a></h1>
<p>只针对 Mysql 8, centos7/Ubuntu20<br>
1 . 使用宝塔面板傻瓜式安装 MySql8.0<br>
2 . 在宝塔-安全处发行 3306 端口, 并且在服务器厂商处放行 3306 端口<br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1604581656064-9c15f40e-b577-4f4c-aea8-c6db26e90fb5.png#align=left&amp;display=inline&amp;height=182&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=363&amp;originWidth=1647&amp;size=36497&amp;status=done&amp;style=none&amp;width=823.5" alt="image.png"></p>
<ul>
<li><img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1604581684329-30e3cd82-1bdb-4275-96e2-ffe683b8506f.png#align=left&amp;display=inline&amp;height=88&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=176&amp;originWidth=1637&amp;size=21648&amp;status=done&amp;style=none&amp;width=818.5" alt="image.png" class="φcx"></li>
</ul>
<p>3 . 修改配置, 可以直接在宝塔 Mysql 进行配置修改, 在 [mysqld] 下面添加 <code>skip-grant-tables</code> 跳过安全检查. 重启服务器.<br>
4 . 在云主机提供的终端进行以下命令操作<br>
<img src="https://cdn.nlark.com/yuque/0/2020/png/1552854/1608095806879-a5b18c29-5fea-43aa-9179-26742cca7e32.png#align=left&amp;display=inline&amp;height=430&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=859&amp;originWidth=1466&amp;size=141616&amp;status=done&amp;style=none&amp;width=733" alt="image.png"><br>
5 . 登录 Mysql , 修改 root 用户的远程访问权限并修改密码</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 输入之后直接回车, 默认没有密码</span><br><span class="line">mysql <span class="operator">-</span>u root</span><br><span class="line"># 使用 Mysql 数据库</span><br><span class="line">use mysql;</span><br><span class="line"># 查看用户访问端口. root 的host是 localhost, 只允许本地访问, 不允许远程访问, 如果没有root账户需要手动添加, 查看文末链接</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>,host <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"># 修改访问端口</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> host <span class="operator">=</span> <span class="string">'%'</span> <span class="keyword">where</span> <span class="keyword">user</span> <span class="operator">=</span> <span class="string">'root'</span>;</span><br><span class="line"># 刷新服务配置项</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"># 再次查看 root 的host, 发现变成了 <span class="operator">%</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>,host <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"># 修改 root 用户的密码, 如果出现因为处于 "--skip-grant-tables" 模式而产生的限制, 先执行一次 FLUSH PRIVILEGES;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">'root'</span>@<span class="string">'%'</span> IDENTIFIED <span class="keyword">WITH</span> MYSQL_NATIVE_PASSWORD <span class="keyword">BY</span> <span class="string">'新密码'</span>;</span><br><span class="line"># 退出, 将 "--skip-grant-tables" 属性注释了</span><br><span class="line">vi <span class="operator">/</span>etc<span class="operator">/</span>my.cnf</span><br></pre></td></tr></tbody></table></figure>
<p>6 . 测试新密码是否可以登录</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql <span class="operator">-</span>uroot <span class="operator">-</span>p密码</span><br></pre></td></tr></tbody></table></figure>
<p>7 . 重启 MySQL</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service mysql restart</span><br><span class="line">service</span><br></pre></td></tr></tbody></table></figure>
<p>8 . 在本机 cmd 测试是否可以远程登录</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql <span class="operator">-</span>h<span class="operator">&lt;</span>主机公网IP<span class="operator">&gt;</span> <span class="operator">-</span>uroot <span class="operator">-</span>p<span class="operator">&lt;</span>新密码<span class="operator">&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>9 . 之后就可以使用远程连接工具来连接服务器了 Navicat 之类的</p>
<h1 id="坑与细节">坑与细节<a title="#坑与细节" href="#坑与细节"></a></h1>
<p>看了别的教程, 觉得不同的 MySql 版本之间的差异还是挺大的, 许多方法在不同的 Mysql 版本中不兼容.<br>
坑如下:</p>
<ol>
<li>使用服务器终端输入 <code>mysql -u root</code> 之后显示 <code>PermissionDenied</code> 认证失败<br>
解决方案: 在 <code>/etc/my.cnf</code> 下的 [mysqld] 添加一行 <code>--skip-grant-tables</code></li>
<li>可以在服务器终端成功登录, 关闭防火墙也没用, 无法在远程登录, 执行<code>netstat -an | grep 3306</code> 或者 <code>lsof -i :3306</code> 没有反应, 3306 端口没有被占用<br>
出现这个情况是因为现在 Mysql 处于 ‘skip-grant-tables’ 模式</li>
<li>远程连接报错 <code>ERROR 2003 (HY000): Can't connect to MySQL server on</code><br>
按照别的教程大多都是到配置文件注释 <code>bind-address</code>, 但是在 mysql 8 中已经没有这个配置了. 其实主要就是 Mysql 处于 <code>--skip-grant-tables</code> 模式, 按照上面的教程步骤来</li>
<li>有的教程使用 <code>UPDATE user SET Password = PASSWORD('newpass') WHERE user = 'root';</code> 来更新密码, MySql 报语法错误<br>
首先 Mysql8 的密码字段名不是 password, 而是 <code>mysql_native_password</code> .其次不是使用的 password 函数. 更改密码的命令应该使用</li>
</ol>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">'test'</span>@<span class="string">'localhost'</span> IDENTIFIED <span class="keyword">WITH</span> MYSQL_NATIVE_PASSWORD <span class="keyword">BY</span> <span class="string">'新密码'</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>参考:</p>
<p><a href="https://www.cnblogs.com/zyhcs/p/13866873.html" target="_blank" rel="external nofollow noopener">Navicat 连接远程 MySQL8.0 数据库</a><br>
<a href="https://blog.csdn.net/weixin_43671497/article/details/84931578" target="_blank" rel="external nofollow noopener">Linux 下 mysql 服务存在，但是 3306 端口监听不存在，远程连接不上</a><br>
<a href="https://blog.csdn.net/niuchenliang524/article/details/104607496/" target="_blank" rel="external nofollow noopener">Mysql 中 root 账户丢失</a></p>
</div><is-f class="φcc φv φs"><!----><ul class="φcg"><li class="φce"><strong class="φcf">Author<span>:</span></strong><p class="φcd">Mvbbb</p></li><li class="φce"><strong class="φcf">Link<span>:</span></strong><p class="φcd"><a href="https://mvbbb.github.io/sb74kg/" title="Linux服务器安装 MySql 8.0并配置远程连接">https://mvbbb.github.io/sb74kg/</a></p></li><li class="φce"><strong class="φcf">Copyright<span>:</span></strong><p class="φcd">Attribution-NonCommercial-NoDerivatives 4.0 International (<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener" target="_blank">CC BY-NC-ND 4.0</a>)</p></li><!----></ul><!----></is-f><!----><!----><!----></article><footer class="φgb φh"><!----><div class="φgc"><a class="φgd φgf φu" href="/gmx84f">近期规划-碎碎念</a><!----><a class="φgd φge φu" href="/ldcb18">内存管理</a><!----></div><!----></footer><is-e class="φbz φh"><div issnippet="" class="φbh"><div id="tcomment"></div>


</div><!----><!----><!----><!----></is-e><!----><!----><!----></is-s><!----></main><!----></div></div></div><is-g class="φch"><div class="φcq"><span class="φbg icon-up"></span><span class="φbg icon-down"></span><!----><span class="φbg icon-toc"></span><!----><span class="φbg icon-search"></span><!----></div><div class="φcj φck"><svg class="φcp"><defs><filter id="dp"><feGaussianBlur in="SourceGraphic" stdDeviation="2"></feGaussianBlur></filter></defs><circle filter="url(#dp)" fill="rgba(0,0,0,.3)" cx="50%" cy="52%" r="44%"></circle><circle cx="50%" cy="50%" r="44%" class="φcl φbb"></circle><circle cx="50%" cy="50%" r="48%" class="φco φba" stroke-dasharray="0% 314.15926%"></circle><!----><g class="φcm"><circle r=".2rem" cx="0" cy="-.8rem"></circle><circle r=".2rem"></circle><circle r=".2rem" cx="0" cy=".8rem"></circle></g><!----></svg></div></is-g><is-n class="φev φf"><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">1 </span><!----><span class="φfc">教程</span></a><!----></div><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">2 </span><!----><span class="φfc">坑与细节</span></a><!----></div><!----></is-n><!----><!----></is-a><!-- hexo injector body_begin end --><!-- hexo injector body_end start --><script src="https://cdn.jsdelivr.net/npm/twikoo@1.0.0/dist/twikoo.all.min.js"></script><script src="/runtime.b15aa7186c559b492b7d.js"></script><script src="/polyfills.824ff89b5f3ca4543a31.js"></script><script src="/main.03652fc423a687c817e8.js"></script><!-- hexo injector body_end end -->

</body></html>