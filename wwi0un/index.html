<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8">
<meta name="referrer" content="no-referrer">
<title>关于PageHelper 分页插件的使用以及其中的坑 - Yu</title>
<base href="/">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<link rel="canonical" href="https://mvbbb.github.io/wwi0un/">
<link rel="icon" type="image/x-icon" href="/images/web.png">

<meta name="description" content="categories:[Java,Spring] tags:[mybatis,SpringBoot,MySql]  如何使用 直接导入依赖 123456<!--分页插件--><dependency>  <groupId>com.github.pagehelper</groupId>  <artifactId>pagehelper-spri">
<meta property="og:type" content="website">
<meta property="og:title" content="关于PageHelper 分页插件的使用以及其中的坑">
<meta property="og:url" content="https://mvbbb.github.io/wwi0un/index.html">
<meta property="og:site_name" content="Yu">
<meta property="og:description" content="categories:[Java,Spring] tags:[mybatis,SpringBoot,MySql]  如何使用 直接导入依赖 123456<!--分页插件--><dependency>  <groupId>com.github.pagehelper</groupId>  <artifactId>pagehelper-spri">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://mvbbb.github.io/wwi0un/images/avatar.jpg">
<meta property="article:published_time" content="2021-02-01T10:05:47.000Z">
<meta property="article:modified_time" content="2021-02-03T04:20:57.253Z">
<meta property="article:author" content="Mvbbb">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mvbbb.github.io/wwi0un/images/avatar.jpg">
<script type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","publisher":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"url":"https://mvbbb.github.io","image":"https://mvbbb.github.io/images/avatar.jpg","description":"Who i am,who u are","author":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"inLanguage":{"@type":"Language","alternateName":"en"}},{"@context":"http://schema.org","@type":"Article","articleSection":"","url":"https://mvbbb.github.io/wwi0un/","headline":"关于PageHelper 分页插件的使用以及其中的坑","image":"https://mvbbb.github.io/images/avatar.jpg","datePublished":"2021-02-01T10:05:47.000Z","dateModified":"2021-02-03T04:20:57.253Z","keywords":"","description":"Who i am,who u are","publisher":{"@type":"Organization","name":"Yu","logo":{"@type":"ImageObject","url":"https://mvbbb.github.io/images/avatar.jpg"}},"author":{"@type":"Person","name":"Mvbbb","description":"Who i am,who u are","image":"https://mvbbb.github.io/images/avatar.jpg"},"inLanguage":{"@type":"Language","alternateName":"en"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mvbbb.github.io/wwi0un/"}}]</script><link rel="alternate" type="application/atom+xml" title="Yu" href="/rss2.xml">
<script async="" src="//www.googletagmanager.com/gtag/js?id=UA-160027215-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)};gtag('js',new Date());gtag('config','UA-160027215-1');</script>
<meta name="theme-color" content=""><script type="application/json" is="state">{&q;api/d3dpMHVu.json&q;:{&q;title&q;:&q;关于PageHelper 分页插件的使用以及其中的坑&q;,&q;date&q;:&q;2021-02-01T10:05:47.000Z&q;,&q;date_formatted&q;:{&q;ll&q;:&q;Feb 1, 2021&q;,&q;L&q;:&q;02/01/2021&q;,&q;MM-DD&q;:&q;02-01&q;},&q;link&q;:&q;wwi0un&q;,&q;comments&q;:true,&q;updated&q;:&q;2021-02-03T04:20:57.253Z&q;,&q;content&q;:&q;&l;p&g;categories:[Java,Spring]&l;br&g;\ntags:[mybatis,SpringBoot,MySql]&l;/p&g;\n&l;hr&g;\n&l;h1 id=\&q;如何使用\&q;&g;如何使用&l;a title=\&q;#如何使用\&q; href=\&q;#如何使用\&q;&g;&l;/a&g;&l;/h1&g;\n&l;p&g;直接导入依赖&l;/p&g;\n&l;figure class=\&q;highlight xml\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;&a;lt;!--分页插件--&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;dependency&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;groupId&l;/span&g;&a;gt;&l;/span&g;com.github.pagehelper&l;span class=\&q;tag\&q;&g;&a;lt;/&l;span class=\&q;name\&q;&g;groupId&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;artifactId&l;/span&g;&a;gt;&l;/span&g;pagehelper-spring-boot-starter&l;span class=\&q;tag\&q;&g;&a;lt;/&l;span class=\&q;name\&q;&g;artifactId&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;version&l;/span&g;&a;gt;&l;/span&g;1.2.13&l;span class=\&q;tag\&q;&g;&a;lt;/&l;span class=\&q;name\&q;&g;version&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;tag\&q;&g;&a;lt;/&l;span class=\&q;name\&q;&g;dependency&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;常见的使用方式&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;function\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; PageInfo &l;span class=\&q;title\&q;&g;findPage&l;/span&g;&l;span class=\&q;params\&q;&g;(&l;span class=\&q;keyword\&q;&g;int&l;/span&g; pageNum,&l;span class=\&q;keyword\&q;&g;int&l;/span&g; pageSize)&l;/span&g;&l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;      PageHelper.startPage(pageNum,pageSize);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;      List&a;lt;User&a;gt; list=userDao.selectAll();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;      PageInfo pageInfo = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; PageInfo(list);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;      &l;span class=\&q;keyword\&q;&g;return&l;/span&g; pageInfo;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g; &a;#125;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;说明&l;/p&g;\n&l;ol&g;\n&l;li&g;&l;code&g;startPage()&l;/code&g;  方法调用后必须紧跟 MyBatis 查询方法&l;/li&g;\n&l;li&g;&l;code&g;startPage()&l;/code&g;  方法是静态方法, 只需要传入 &l;code&g;pageNum&l;/code&g;  和 &l;code&g;pageSize&l;/code&g;  两个参数&l;/li&g;\n&l;li&g;我们不需要对查询 SQL 做修改就可以达到分页的效果&l;/li&g;\n&l;li&g;PageInfo 里面包含了一整个页面的信息&l;/li&g;\n&l;li&g;PageInfo 构造函数传入的参数必须是 &l;code&g;startPage()&l;/code&g;  后的那个方法得到的对象（原因下文解释）&l;/li&g;\n&l;/ol&g;\n&l;h1 id=\&q;pageinfo-中的参数说明\&q;&g;PageInfo 中的参数说明&l;a title=\&q;#pageinfo-中的参数说明\&q; href=\&q;#pageinfo-中的参数说明\&q;&g;&l;/a&g;&l;/h1&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;14&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;15&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;16&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;17&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;18&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;19&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;20&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;21&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;22&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;23&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;24&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;25&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;26&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;27&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;28&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;29&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;30&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;31&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;32&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;33&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;34&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;35&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;36&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;class\&q;&g;&l;span class=\&q;keyword\&q;&g;class&l;/span&g; &l;span class=\&q;title\&q;&g;PageInfo&l;/span&g;&a;lt;&l;span class=\&q;title\&q;&g;T&l;/span&g;&a;gt; &l;span class=\&q;keyword\&q;&g;extends&l;/span&g; &l;span class=\&q;title\&q;&g;PageSerializable&l;/span&g;&a;lt;&l;span class=\&q;title\&q;&g;T&l;/span&g;&a;gt; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 当前页的页码&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; pageNum;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 页大小, 为分页时提供的参数&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; pageSize;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 当前页的记录条数&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; size;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 由第几条开始(数据库行号)&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; startRow;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 第几条结束(数据库行号)&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; endRow;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 一共有多少页&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; pages;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 前一页的页号, 如果没有前一页就是为0&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; prePage;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 后一页的页号, 如果没有前一页就是为0&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; nextPage;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 是否是第一页&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;boolean&l;/span&g; isFirstPage;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 是否是最后一页&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;boolean&l;/span&g; isLastPage;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 是否有前一页&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;boolean&l;/span&g; hasPreviousPage;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 是否有后一页&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;boolean&l;/span&g; hasNextPage;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 每页显示的页码个数, 在构造方法里面被默认设置为8&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; navigatePages;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 页码数&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g;[] navigatepageNums;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 首页&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; navigateFirstPage;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 尾页&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;int&l;/span&g; navigateLastPage;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 方法省略&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&a;#125;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;另外它还继承自 &l;code&g;PageSerializable``&a;lt;``T``&a;gt;&l;/code&g;&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;keyword\&q;&g;public&l;/span&g; &l;span class=\&q;class\&q;&g;&l;span class=\&q;keyword\&q;&g;class&l;/span&g; &l;span class=\&q;title\&q;&g;PageSerializable&l;/span&g;&a;lt;&l;span class=\&q;title\&q;&g;T&l;/span&g;&a;gt; &l;span class=\&q;keyword\&q;&g;implements&l;/span&g; &l;span class=\&q;title\&q;&g;Serializable&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;private&l;/span&g; &l;span class=\&q;keyword\&q;&g;static&l;/span&g; &l;span class=\&q;keyword\&q;&g;final&l;/span&g; &l;span class=\&q;keyword\&q;&g;long&l;/span&g; serialVersionUID = &l;span class=\&q;number\&q;&g;1L&l;/span&g;;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 当前页的记录条数&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;protected&l;/span&g; &l;span class=\&q;keyword\&q;&g;long&l;/span&g; total;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 当前页的每一条记录&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;protected&l;/span&g; List&a;lt;T&a;gt; list;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 方法省略&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&a;#125;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;h1 id=\&q;pagehelper-使用中的坑\&q;&g;PageHelper 使用中的坑&l;a title=\&q;#pagehelper-使用中的坑\&q; href=\&q;#pagehelper-使用中的坑\&q;&g;&l;/a&g;&l;/h1&g;\n&l;h2 id=\&q;需求描述\&q;&g;需求描述&l;a title=\&q;#需求描述\&q; href=\&q;#需求描述\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;出于安全性的考虑, 我想要查询到的 POJO 映射到 VO 类中，VO 类相比 POJO 类缺少了某些私密属性， 将 VO 作为基本元素封装到 PageInfo 中, 于是我写出来如下代码&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;14&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;15&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;function\&q;&g;PageInfo&a;lt;PostItemVO&a;gt; &l;span class=\&q;title\&q;&g;selectAll&l;/span&g;&l;span class=\&q;params\&q;&g;()&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 开启分页 （PageNum,PageSize）&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    PageHelper.startPage(&l;span class=\&q;number\&q;&g;1&l;/span&g;, &l;span class=\&q;number\&q;&g;2&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    List&a;lt;Post&a;gt; posts = postMapper.selectAll();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// 属性拷贝&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    List&a;lt;PostItemVO&a;gt; postItemVOS = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; ArrayList&a;lt;&a;gt;();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;for&l;/span&g; (Post post : posts) &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        PostItemVO postItemVO = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; PostItemVO();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        BeanUtils.copyProperties(post,postItemVO);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;        postItemVOS.add(postItemVO);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &a;#125;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;comment\&q;&g;// PageInfo 封装&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    PageInfo&a;lt;PostItemVO&a;gt; pageInfo = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; PageInfo&a;lt;PostItemVO&a;gt;(postItemVOS);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;return&l;/span&g; pageInfo;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&a;#125;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;Post 是我的 POJO, PostVO 是对应的 VO 类。数据库中查询得到 Post 集合，将其属性拷贝到 PostVO 集合。&l;br&g;\n乍一看其实写的不存在问题，但是我们在查询时就会出现问题&l;br&g;\n数据库表如下, 共有四条记录&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2021/png/1552854/1612313561344-6bbadec9-4699-43bc-bd0f-7a584f53743a.png#align=left&a;amp;display=inline&a;amp;height=74&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=147&a;amp;originWidth=1514&a;amp;size=27557&a;amp;status=done&a;amp;style=none&a;amp;width=757\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n得到的 PageInfo 如下&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2021/png/1552854/1612313846398-b64eecb6-7e69-41db-b327-8a35fe735b38.png#align=left&a;amp;display=inline&a;amp;height=492&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=492&a;amp;originWidth=625&a;amp;size=129408&a;amp;status=done&a;amp;style=none&a;amp;width=625\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n数据库中共有 4 条记录, 但是查询得到的 total 只有 2 条, 除此之外 &l;code&g;nextPage&l;/code&g; , &l;code&g;endRow....&l;/code&g;  字段都出现了问题。&l;/p&g;\n&l;h2 id=\&q;解决方法\&q;&g;解决方法&l;a title=\&q;#解决方法\&q; href=\&q;#解决方法\&q;&g;&l;/a&g;&l;/h2&g;\n&l;h3 id=\&q;方法一\&q;&g;方法一&l;a title=\&q;#方法一\&q; href=\&q;#方法一\&q;&g;&l;/a&g;&l;/h3&g;\n&l;p&g;先直接将查询结果封装到一个 PageInfo 中, 之后将将该 PageInfo 的 list 取出来做改造&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;14&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;15&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;PageInfo&a;lt; selectAll() &a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\tPageHelper.startPage(&l;span class=\&q;number\&q;&g;1&l;/span&g;, &l;span class=\&q;number\&q;&g;2&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\tList&a;lt;Post&a;gt; posts = postMapper.selectAll();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\t&l;span class=\&q;comment\&q;&g;// 直接将Post封装&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\tPageInfo pageInfo = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; PageInfo&a;lt;&a;gt;(posts);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\t&l;span class=\&q;comment\&q;&g;// 取出List进行数据转移&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\tArrayList&a;lt;PostItemVO&a;gt; postItemVOS = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; ArrayList&a;lt;&a;gt;();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\tpageInfo.getList().forEach(post-&a;gt;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\t\tPostItemVO postItemVO = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; PostItemVO();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\t\tBeanUtils.copyProperties(post,postItemVO);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\t\tpostItemVOS.add(postItemVO);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\t&a;#125;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\tpageInfo.setList(postItemVOS);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t\t&l;span class=\&q;keyword\&q;&g;return&l;/span&g; pageInfo;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;\t&a;#125;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;查询结果如下&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2021/png/1552854/1612321919969-4c00512a-c405-4abe-b0eb-6bdd34f5e6c2.png#align=left&a;amp;display=inline&a;amp;height=459&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=459&a;amp;originWidth=608&a;amp;size=35259&a;amp;status=done&a;amp;style=none&a;amp;width=608\&q; alt=\&q;image.png\&q;&g;&l;/p&g;\n&l;h3 id=\&q;方法二-推荐\&q;&g;方法二 推荐&l;a title=\&q;#方法二-推荐\&q; href=\&q;#方法二-推荐\&q;&g;&l;/a&g;&l;/h3&g;\n&l;p&g;&l;strong&g;更加优雅的方式&l;/strong&g;, 我们对查询语句进行改造, 使其直接返回一个 VO 集合，也就是说数据库表直接映射到 VO 上, 之后直接将该 List 封装在 PageInfo 之后, 直接返回就行了.&l;br&g;\n1 需要对 &l;code&g;PostMapper.xml&l;/code&g;  进行修改&l;/p&g;\n&l;figure class=\&q;highlight xml\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;7&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;8&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;9&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;10&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;11&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;12&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;13&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;14&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;15&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;16&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;17&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;&a;lt;!--结果映射--&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;resultMap&l;/span&g; &l;span class=\&q;attr\&q;&g;id&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;ItemMap&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;type&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;im.yzh.mymyblog.model.vo.PostItemVO&a;quot;&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;id&l;/span&g; &l;span class=\&q;attr\&q;&g;column&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;id&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;jdbcType&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;BIGINT&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;property&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;id&a;quot;&l;/span&g; /&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;result&l;/span&g; &l;span class=\&q;attr\&q;&g;column&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;title&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;jdbcType&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;VARCHAR&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;property&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;title&a;quot;&l;/span&g; /&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;result&l;/span&g; &l;span class=\&q;attr\&q;&g;column&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;update_time&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;jdbcType&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;TIMESTAMP&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;property&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;updateTime&a;quot;&l;/span&g; /&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;result&l;/span&g; &l;span class=\&q;attr\&q;&g;column&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;published&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;jdbcType&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;BIT&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;property&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;published&a;quot;&l;/span&g; /&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;result&l;/span&g; &l;span class=\&q;attr\&q;&g;column&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;category_id&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;jdbcType&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;BIGINT&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;property&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;categoryId&a;quot;&l;/span&g; /&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;tag\&q;&g;&a;lt;/&l;span class=\&q;name\&q;&g;resultMap&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;&a;lt;!--一共有哪些字段--&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;sql&l;/span&g; &l;span class=\&q;attr\&q;&g;id&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;Item_Column_List&a;quot;&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  id, title, update_time, published, category_id&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;tag\&q;&g;&a;lt;/&l;span class=\&q;name\&q;&g;sql&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;comment\&q;&g;&a;lt;!--查询SQL--&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;select&l;/span&g; &l;span class=\&q;attr\&q;&g;id&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;selectAllItem&a;quot;&l;/span&g; &l;span class=\&q;attr\&q;&g;resultMap&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;ItemMap&a;quot;&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  select &l;span class=\&q;tag\&q;&g;&a;lt;&l;span class=\&q;name\&q;&g;include&l;/span&g; &l;span class=\&q;attr\&q;&g;refid&l;/span&g;=&l;span class=\&q;string\&q;&g;&a;quot;Item_Column_List&a;quot;&l;/span&g;/&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;  from post order by update_time desc&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;tag\&q;&g;&a;lt;/&l;span class=\&q;name\&q;&g;select&l;/span&g;&a;gt;&l;/span&g;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;2 在 PostMapper 接口中添加相关方法&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;function\&q;&g;List&a;lt;PostItemVO&a;gt; &l;span class=\&q;title\&q;&g;selectAllItem&l;/span&g;&l;span class=\&q;params\&q;&g;()&l;/span&g;&l;/span&g;;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;3 编写测试&l;/p&g;\n&l;figure class=\&q;highlight java\&q;&g;&l;table&g;&l;tr&g;&l;td class=\&q;gutter\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;1&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;2&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;3&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;4&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;5&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;6&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;td class=\&q;code\&q;&g;&l;pre&g;&l;span class=\&q;line\&q;&g;&l;span class=\&q;function\&q;&g;PageInfo&a;lt;PostItemVO&a;gt; &l;span class=\&q;title\&q;&g;selectAllItem&l;/span&g;&l;span class=\&q;params\&q;&g;()&l;/span&g; &l;/span&g;&a;#123;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    PageHelper.startPage(&l;span class=\&q;number\&q;&g;1&l;/span&g;, &l;span class=\&q;number\&q;&g;2&l;/span&g;);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    List&a;lt;PostItemVO&a;gt; posts = postMapper.selectAllItem();&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    PageInfo&a;lt;PostItemVO&a;gt; pageInfo = &l;span class=\&q;keyword\&q;&g;new&l;/span&g; PageInfo&a;lt;PostItemVO&a;gt;(posts);&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;    &l;span class=\&q;keyword\&q;&g;return&l;/span&g; pageInfo;&l;/span&g;&l;br&g;&l;span class=\&q;line\&q;&g;&a;#125;&l;/span&g;&l;br&g;&l;/pre&g;&l;/td&g;&l;/tr&g;&l;/table&g;&l;/figure&g;\n&l;p&g;&l;img src=\&q;https://cdn.nlark.com/yuque/0/2021/png/1552854/1612322202997-33e37760-6119-4caf-954e-d63bfd7e993e.png#align=left&a;amp;display=inline&a;amp;height=483&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=483&a;amp;originWidth=598&a;amp;size=37543&a;amp;status=done&a;amp;style=none&a;amp;width=598\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n如果你有更好的解决方法欢迎留言评论&l;/p&g;\n&l;h2 id=\&q;原因分析\&q;&g;原因分析&l;a title=\&q;#原因分析\&q; href=\&q;#原因分析\&q;&g;&l;/a&g;&l;/h2&g;\n&l;p&g;total 字段为例, 为什么正确的查询结果是 4, 但是用之前的错误查询方法的结果是 2。&l;br&g;\n先分析之前的错误查询方法的代码。&l;br&g;\n打个断点，我们发现，在 &l;code&g;startPage()&l;/code&g;  调用之后, 随后的一个查询被进行了分页, 查询结果被封装为了一个 Page 对象：&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2021/png/1552854/1612323795636-b67c1d76-d6b5-43ce-9d0c-9159becd782f.png#align=left&a;amp;display=inline&a;amp;height=268&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=432&a;amp;originWidth=1202&a;amp;size=87843&a;amp;status=done&a;amp;style=none&a;amp;width=746\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n查看 &l;code&g;com.github.pagehelper.``Page&l;/code&g; 源代码, Page 对象中包含了之后被封装到 PageInfo 中的信息：&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2021/png/1552854/1612323907756-e7053454-b115-46fc-89be-ea0fe374dd1a.png#align=left&a;amp;display=inline&a;amp;height=337&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=495&a;amp;originWidth=1096&a;amp;size=73958&a;amp;status=done&a;amp;style=none&a;amp;width=746\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n也就是说, 我们的查询结果就已经包含了 PageInfo 之后需要的信息。查询得到的是一个 Page 实例，而不仅仅是一个 List， 所以说， 只对 &l;code&g;posts&l;/code&g; 进行 POJO 的拷贝是不够的, 这会丢失我们的分页信息。&l;/p&g;\n&l;p&g;对正确的查询过程进行调试分析：&l;br&g;\n1 被分页之后得到一个 Page 对象：&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2021/png/1552854/1612324668885-058571c8-603c-4a6d-a7ba-6b5375ff8f23.png#align=left&a;amp;display=inline&a;amp;height=597&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=735&a;amp;originWidth=918&a;amp;size=103685&a;amp;status=done&a;amp;style=none&a;amp;width=746\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n2 调用 PageInfo 构造函数会执行一个方法判断传入的参数是否为 Page 对象：&l;br&g;\n&l;img src=\&q;https://cdn.nlark.com/yuque/0/2021/png/1552854/1612324841063-30583798-15ed-45f4-a3f5-f69a79a94603.png#align=left&a;amp;display=inline&a;amp;height=246&a;amp;margin=%5Bobject%20Object%5D&a;amp;name=image.png&a;amp;originHeight=279&a;amp;originWidth=845&a;amp;size=28124&a;amp;status=done&a;amp;style=none&a;amp;width=746\&q; alt=\&q;image.png\&q;&g;&l;br&g;\n假如是之前的那种错误方法, 我们传入的是 List 对象, 那么 &l;code&g;this.total&l;/code&g;  就被初始化为了 List 的长度。 这就解释了为什么错误的方法得到的分页对象的 total 为 2&l;/p&g;\n&l;h1 id=\&q;参考资料\&q;&g;参考资料&l;a title=\&q;#参考资料\&q; href=\&q;#参考资料\&q;&g;&l;/a&g;&l;/h1&g;\n&l;p&g;&l;a href=\&q;https://pagehelper.github.io/docs/howtouse/\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;官方文档-如何使用分页插件&l;/a&g;&l;br&g;\n&l;a href=\&q;https://blog.csdn.net/weixin_45423451/article/details/103034921?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&a;amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control\&q; target=\&q;_blank\&q; rel=\&q;external nofollow noopener\&q;&g;CSDN-PageHelper，从 pageinfo 中取到的 total 不正确的处理。&l;/a&g;&l;/p&g;\n&q;,&q;prev&q;:{&q;title&q;:&q;Python与算法竞赛以及常用模板&q;,&q;link&q;:&q;nmmxgt&q;},&q;next&q;:{&q;title&q;:&q;mybatis-generator-maven插件与lombok的引入&q;,&q;link&q;:&q;iq1x0p&q;},&q;plink&q;:&q;https://mvbbb.github.io/wwi0un/&q;,&q;toc&q;:[{&q;id&q;:&q;如何使用&q;,&q;title&q;:&q;如何使用&q;,&q;index&q;:&q;1&q;},{&q;id&q;:&q;pageinfo-中的参数说明&q;,&q;title&q;:&q;PageInfo 中的参数说明&q;,&q;index&q;:&q;2&q;},{&q;id&q;:&q;pagehelper-使用中的坑&q;,&q;title&q;:&q;PageHelper 使用中的坑&q;,&q;index&q;:&q;3&q;,&q;children&q;:[{&q;id&q;:&q;需求描述&q;,&q;title&q;:&q;需求描述&q;,&q;index&q;:&q;3.1&q;},{&q;id&q;:&q;解决方法&q;,&q;title&q;:&q;解决方法&q;,&q;index&q;:&q;3.2&q;,&q;children&q;:[{&q;id&q;:&q;方法一&q;,&q;title&q;:&q;方法一&q;,&q;index&q;:&q;3.2.1&q;},{&q;id&q;:&q;方法二-推荐&q;,&q;title&q;:&q;方法二 推荐&q;,&q;index&q;:&q;3.2.2&q;}]},{&q;id&q;:&q;原因分析&q;,&q;title&q;:&q;原因分析&q;,&q;index&q;:&q;3.3&q;}]},{&q;id&q;:&q;参考资料&q;,&q;title&q;:&q;参考资料&q;,&q;index&q;:&q;4&q;}],&q;copyright&q;:{&q;author&q;:&q;Mvbbb&q;,&q;link&q;:&q;&l;a href=\&q;https://mvbbb.github.io/wwi0un/\&q; title=\&q;关于PageHelper 分页插件的使用以及其中的坑\&q;&g;https://mvbbb.github.io/wwi0un/&l;/a&g;&q;,&q;license&q;:&q;Attribution-NonCommercial-NoDerivatives 4.0 International (&l;a href=\&q;https://creativecommons.org/licenses/by-nc-sa/4.0/\&q; rel=\&q;external nofollow noopener\&q; target=\&q;_blank\&q;&g;CC BY-NC-ND 4.0&l;/a&g;)&q;}}}</script></head><body lang="en"><div style="display:none"><script type="text/javascript" src="https://s9.cnzz.com/z_stat.php?id=1279526637&amp;web_id=1279526637"></script></div>
<!-- hexo injector head_end start --><link href="//fonts.googleapis.com/css?family=Baloo+Bhaijaan|Inconsolata|Josefin+Sans|Montserrat" rel="stylesheet"><link href="/styles.43478ea7e28ed563c48b.css" rel="stylesheet">
<script src="/config.f667b9e14173c512056d.js"></script>

<link rel="stylesheet" href="/theme.6191587147d30da44d8f.css" is="theme">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0">
<!-- hexo injector body_begin start --><is-a class="φbm φk" ng-version="10.0.11"><is-l class="φeb φh"><div class="φel"><section class="φem"><header class="φec φf"><!----><is-c class="φed"><img draggable="false" class="φbw φw" src="images/avatar.jpg" alt="" title="" width="160" height="160"></is-c><!----><a href="" class="φef φa φu">Mvbbb</a><p class="φee">Who i am,who u are</p></header><div class="φeq φf"><a routerlink="/archives" class="φer φu" href="/archives"><span class="φd">45</span><span>Archives</span></a><a class="φer φu" href="/categories/Java"><span class="φd">14</span><span>Categories</span></a><!----><a routerlink="/tags" class="φer φu" href="/tags"><span class="φd">34</span><span>Tags</span></a><!----></div><!----><nav class="φen"><a class="φeo φbd φj φc φu φo" href="/">Home</a><!----><!----><!----><a class="φeo φbd φj φc φu φo" href="/about">About</a><!----><!----><!----><a class="φeo φbd φj φc φu φo" href="/search">Search</a><!----><!----><!----><!----><a target="_blank" rel="external nofollow noopener" class="φeo φbd φj φc φu φo" href="https://www.yuque.com/u1296515/zb4bwb">Yuque</a><!----><!----><!----></nav><!----><!----></section><footer class="φeg φeh"><div class="φej"><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-email" href="mailto:3212618781@qq.com">email</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-feed" href="https://mvbbb.github.io/rss2.xml">feed</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-github" href="https://github.com/Mvbbb">github</a><a target="_blank" rel="external nofollow noopener" class="φek φbg φu icon-myspace" href="/links">myspace</a><!----></div><!----><p class="φbk φz">© 2019-2021 ❤ <a href="https://github.com/Mvbbb">Mvbbb</a></p><!----><!----><!----></footer></div></is-l><div class="φbo"><div class="φbn"><div class="φbs φbe"><main class="φbr φbf"><router-outlet></router-outlet><is-s class="φfx φf"><header class="φgh φgi" style="background-image:;background-color:;"><div class="φgq"><h1 class="φgt">关于PageHelper 分页插件的使用以及其中的坑</h1><!----><p class="φgj φr"><span class="φgk φgo">Feb 1, 2021</span><!----><!----><!----></p><!----><!----></div></header><article itemscope="" itemtype="http://schema.org/Article" class="φga" data-title="关于PageHelper 分页插件的使用以及其中的坑"><div itemprop="articleBody" issnippet="" iszoomable="" class="φbk φh φz"><p>categories:[Java,Spring]<br>
tags:[mybatis,SpringBoot,MySql]</p>
<hr>
<h1 id="如何使用">如何使用<a title="#如何使用" href="#如何使用"></a></h1>
<p>直接导入依赖</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--分页插件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>常见的使用方式</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> PageInfo <span class="title">findPage</span><span class="params">(<span class="keyword">int</span> pageNum,<span class="keyword">int</span> pageSize)</span></span>{</span><br><span class="line">      PageHelper.startPage(pageNum,pageSize);</span><br><span class="line">      List&lt;User&gt; list=userDao.selectAll();</span><br><span class="line">      PageInfo pageInfo = <span class="keyword">new</span> PageInfo(list);</span><br><span class="line">      <span class="keyword">return</span> pageInfo;</span><br><span class="line"> }</span><br></pre></td></tr></tbody></table></figure>
<p>说明</p>
<ol>
<li><code>startPage()</code>&nbsp; 方法调用后必须紧跟 MyBatis 查询方法</li>
<li><code>startPage()</code>&nbsp; 方法是静态方法, 只需要传入 <code>pageNum</code>&nbsp; 和 <code>pageSize</code>&nbsp; 两个参数</li>
<li>我们不需要对查询 SQL 做修改就可以达到分页的效果</li>
<li>PageInfo 里面包含了一整个页面的信息</li>
<li>PageInfo 构造函数传入的参数必须是 <code>startPage()</code>&nbsp; 后的那个方法得到的对象（原因下文解释）</li>
</ol>
<h1 id="pageinfo-中的参数说明">PageInfo 中的参数说明<a title="#pageinfo-中的参数说明" href="#pageinfo-中的参数说明"></a></h1>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageInfo</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">PageSerializable</span>&lt;<span class="title">T</span>&gt; </span>{</span><br><span class="line">    <span class="comment">// 当前页的页码</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pageNum;</span><br><span class="line">    <span class="comment">// 页大小, 为分页时提供的参数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pageSize;</span><br><span class="line">    <span class="comment">// 当前页的记录条数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">    <span class="comment">// 由第几条开始(数据库行号)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> startRow;</span><br><span class="line">    <span class="comment">// 第几条结束(数据库行号)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> endRow;</span><br><span class="line">    <span class="comment">// 一共有多少页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pages;</span><br><span class="line">    <span class="comment">// 前一页的页号, 如果没有前一页就是为0</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> prePage;</span><br><span class="line">    <span class="comment">// 后一页的页号, 如果没有前一页就是为0</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> nextPage;</span><br><span class="line">    <span class="comment">// 是否是第一页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isFirstPage;</span><br><span class="line">    <span class="comment">// 是否是最后一页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isLastPage;</span><br><span class="line">    <span class="comment">// 是否有前一页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> hasPreviousPage;</span><br><span class="line">    <span class="comment">// 是否有后一页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> hasNextPage;</span><br><span class="line">    <span class="comment">// 每页显示的页码个数, 在构造方法里面被默认设置为8</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> navigatePages;</span><br><span class="line">    <span class="comment">// 页码数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] navigatepageNums;</span><br><span class="line">    <span class="comment">// 首页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> navigateFirstPage;</span><br><span class="line">    <span class="comment">// 尾页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> navigateLastPage;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方法省略</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>另外它还继承自 <code>PageSerializable``&lt;``T``&gt;</code></p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageSerializable</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Serializable</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="comment">// 当前页的记录条数</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">long</span> total;</span><br><span class="line">    <span class="comment">// 当前页的每一条记录</span></span><br><span class="line">    <span class="keyword">protected</span> List&lt;T&gt; list;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方法省略</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="pagehelper-使用中的坑">PageHelper 使用中的坑<a title="#pagehelper-使用中的坑" href="#pagehelper-使用中的坑"></a></h1>
<h2 id="需求描述">需求描述<a title="#需求描述" href="#需求描述"></a></h2>
<p>出于安全性的考虑, 我想要查询到的 POJO 映射到 VO 类中，VO 类相比 POJO 类缺少了某些私密属性， 将 VO 作为基本元素封装到 PageInfo 中, 于是我写出来如下代码</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">PageInfo&lt;PostItemVO&gt; <span class="title">selectAll</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// 开启分页 （PageNum,PageSize）</span></span><br><span class="line">    PageHelper.startPage(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    List&lt;Post&gt; posts = postMapper.selectAll();</span><br><span class="line">    <span class="comment">// 属性拷贝</span></span><br><span class="line">    List&lt;PostItemVO&gt; postItemVOS = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Post post : posts) {</span><br><span class="line">        PostItemVO postItemVO = <span class="keyword">new</span> PostItemVO();</span><br><span class="line">        BeanUtils.copyProperties(post,postItemVO);</span><br><span class="line">        postItemVOS.add(postItemVO);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// PageInfo 封装</span></span><br><span class="line">    PageInfo&lt;PostItemVO&gt; pageInfo = <span class="keyword">new</span> PageInfo&lt;PostItemVO&gt;(postItemVOS);</span><br><span class="line">    <span class="keyword">return</span> pageInfo;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Post 是我的 POJO, PostVO 是对应的 VO 类。数据库中查询得到 Post 集合，将其属性拷贝到 PostVO 集合。<br>
乍一看其实写的不存在问题，但是我们在查询时就会出现问题<br>
数据库表如下, 共有四条记录<br>
<img src="https://cdn.nlark.com/yuque/0/2021/png/1552854/1612313561344-6bbadec9-4699-43bc-bd0f-7a584f53743a.png#align=left&amp;display=inline&amp;height=74&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=147&amp;originWidth=1514&amp;size=27557&amp;status=done&amp;style=none&amp;width=757" alt="image.png"><br>
得到的 PageInfo 如下<br>
<img src="https://cdn.nlark.com/yuque/0/2021/png/1552854/1612313846398-b64eecb6-7e69-41db-b327-8a35fe735b38.png#align=left&amp;display=inline&amp;height=492&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=492&amp;originWidth=625&amp;size=129408&amp;status=done&amp;style=none&amp;width=625" alt="image.png"><br>
数据库中共有 4 条记录, 但是查询得到的 total 只有 2 条, 除此之外 <code>nextPage</code>&nbsp;, <code>endRow....</code>&nbsp; 字段都出现了问题。</p>
<h2 id="解决方法">解决方法<a title="#解决方法" href="#解决方法"></a></h2>
<h3 id="方法一">方法一<a title="#方法一" href="#方法一"></a></h3>
<p>先直接将查询结果封装到一个 PageInfo 中, 之后将将该 PageInfo 的 list 取出来做改造</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">PageInfo&lt; selectAll() {</span><br><span class="line">		PageHelper.startPage(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">		List&lt;Post&gt; posts = postMapper.selectAll();</span><br><span class="line">		<span class="comment">// 直接将Post封装</span></span><br><span class="line">		PageInfo pageInfo = <span class="keyword">new</span> PageInfo&lt;&gt;(posts);</span><br><span class="line">		<span class="comment">// 取出List进行数据转移</span></span><br><span class="line">		ArrayList&lt;PostItemVO&gt; postItemVOS = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		pageInfo.getList().forEach(post-&gt;{</span><br><span class="line">			PostItemVO postItemVO = <span class="keyword">new</span> PostItemVO();</span><br><span class="line">			BeanUtils.copyProperties(post,postItemVO);</span><br><span class="line">			postItemVOS.add(postItemVO);</span><br><span class="line">		});</span><br><span class="line">		pageInfo.setList(postItemVOS);</span><br><span class="line">		<span class="keyword">return</span> pageInfo;</span><br><span class="line">	}</span><br></pre></td></tr></tbody></table></figure>
<p>查询结果如下<br>
<img src="https://cdn.nlark.com/yuque/0/2021/png/1552854/1612321919969-4c00512a-c405-4abe-b0eb-6bdd34f5e6c2.png#align=left&amp;display=inline&amp;height=459&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=459&amp;originWidth=608&amp;size=35259&amp;status=done&amp;style=none&amp;width=608" alt="image.png"></p>
<h3 id="方法二-推荐">方法二 推荐<a title="#方法二-推荐" href="#方法二-推荐"></a></h3>
<p><strong>更加优雅的方式</strong>, 我们对查询语句进行改造, 使其直接返回一个 VO 集合，也就是说数据库表直接映射到 VO 上, 之后直接将该 List 封装在 PageInfo 之后, 直接返回就行了.<br>
1 需要对 <code>PostMapper.xml</code>&nbsp; 进行修改</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--结果映射--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"ItemMap"</span> <span class="attr">type</span>=<span class="string">"im.yzh.mymyblog.model.vo.PostItemVO"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"title"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"title"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"update_time"</span> <span class="attr">jdbcType</span>=<span class="string">"TIMESTAMP"</span> <span class="attr">property</span>=<span class="string">"updateTime"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"published"</span> <span class="attr">jdbcType</span>=<span class="string">"BIT"</span> <span class="attr">property</span>=<span class="string">"published"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"category_id"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span> <span class="attr">property</span>=<span class="string">"categoryId"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--一共有哪些字段--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"Item_Column_List"</span>&gt;</span></span><br><span class="line">  id, title, update_time, published, category_id</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--查询SQL--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectAllItem"</span> <span class="attr">resultMap</span>=<span class="string">"ItemMap"</span>&gt;</span></span><br><span class="line">  select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Item_Column_List"</span>/&gt;</span></span><br><span class="line">  from post order by update_time desc</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>2 在 PostMapper 接口中添加相关方法</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">List&lt;PostItemVO&gt; <span class="title">selectAllItem</span><span class="params">()</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p>3 编写测试</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">PageInfo&lt;PostItemVO&gt; <span class="title">selectAllItem</span><span class="params">()</span> </span>{</span><br><span class="line">    PageHelper.startPage(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    List&lt;PostItemVO&gt; posts = postMapper.selectAllItem();</span><br><span class="line">    PageInfo&lt;PostItemVO&gt; pageInfo = <span class="keyword">new</span> PageInfo&lt;PostItemVO&gt;(posts);</span><br><span class="line">    <span class="keyword">return</span> pageInfo;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1552854/1612322202997-33e37760-6119-4caf-954e-d63bfd7e993e.png#align=left&amp;display=inline&amp;height=483&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=483&amp;originWidth=598&amp;size=37543&amp;status=done&amp;style=none&amp;width=598" alt="image.png"><br>
如果你有更好的解决方法欢迎留言评论</p>
<h2 id="原因分析">原因分析<a title="#原因分析" href="#原因分析"></a></h2>
<p>total 字段为例, 为什么正确的查询结果是 4, 但是用之前的错误查询方法的结果是 2。<br>
先分析之前的错误查询方法的代码。<br>
打个断点，我们发现，在 <code>startPage()</code>&nbsp; 调用之后, 随后的一个查询被进行了分页, 查询结果被封装为了一个 Page 对象：<br>
<img src="https://cdn.nlark.com/yuque/0/2021/png/1552854/1612323795636-b67c1d76-d6b5-43ce-9d0c-9159becd782f.png#align=left&amp;display=inline&amp;height=268&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=432&amp;originWidth=1202&amp;size=87843&amp;status=done&amp;style=none&amp;width=746" alt="image.png"><br>
查看 <code>com.github.pagehelper.``Page</code> 源代码, Page 对象中包含了之后被封装到 PageInfo 中的信息：<br>
<img src="https://cdn.nlark.com/yuque/0/2021/png/1552854/1612323907756-e7053454-b115-46fc-89be-ea0fe374dd1a.png#align=left&amp;display=inline&amp;height=337&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=495&amp;originWidth=1096&amp;size=73958&amp;status=done&amp;style=none&amp;width=746" alt="image.png"><br>
也就是说, 我们的查询结果就已经包含了 PageInfo 之后需要的信息。查询得到的是一个 Page 实例，而不仅仅是一个 List， 所以说， 只对 <code>posts</code> 进行 POJO 的拷贝是不够的, 这会丢失我们的分页信息。</p>
<p>对正确的查询过程进行调试分析：<br>
1 被分页之后得到一个 Page 对象：<br>
<img src="https://cdn.nlark.com/yuque/0/2021/png/1552854/1612324668885-058571c8-603c-4a6d-a7ba-6b5375ff8f23.png#align=left&amp;display=inline&amp;height=597&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=735&amp;originWidth=918&amp;size=103685&amp;status=done&amp;style=none&amp;width=746" alt="image.png"><br>
2 调用 PageInfo 构造函数会执行一个方法判断传入的参数是否为 Page 对象：<br>
<img src="https://cdn.nlark.com/yuque/0/2021/png/1552854/1612324841063-30583798-15ed-45f4-a3f5-f69a79a94603.png#align=left&amp;display=inline&amp;height=246&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=279&amp;originWidth=845&amp;size=28124&amp;status=done&amp;style=none&amp;width=746" alt="image.png"><br>
假如是之前的那种错误方法, 我们传入的是 List 对象, 那么 <code>this.total</code>&nbsp; 就被初始化为了 List 的长度。 这就解释了为什么错误的方法得到的分页对象的 total 为 2</p>
<h1 id="参考资料">参考资料<a title="#参考资料" href="#参考资料"></a></h1>
<p><a href="https://pagehelper.github.io/docs/howtouse/" target="_blank" rel="external nofollow noopener">官方文档-如何使用分页插件</a><br>
<a href="https://blog.csdn.net/weixin_45423451/article/details/103034921?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control" target="_blank" rel="external nofollow noopener">CSDN-PageHelper，从 pageinfo 中取到的 total 不正确的处理。</a></p>
</div><is-f class="φcc φv φs"><!----><ul class="φcg"><li class="φce"><strong class="φcf">Author<span>:</span></strong><p class="φcd">Mvbbb</p></li><li class="φce"><strong class="φcf">Link<span>:</span></strong><p class="φcd"><a href="https://mvbbb.github.io/wwi0un/" title="关于PageHelper 分页插件的使用以及其中的坑">https://mvbbb.github.io/wwi0un/</a></p></li><li class="φce"><strong class="φcf">Copyright<span>:</span></strong><p class="φcd">Attribution-NonCommercial-NoDerivatives 4.0 International (<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener" target="_blank">CC BY-NC-ND 4.0</a>)</p></li><!----></ul><!----></is-f><!----><!----><!----></article><footer class="φgb φh"><!----><div class="φgc"><a class="φgd φgf φu" href="/nmmxgt">Python与算法竞赛以及常用模板</a><!----><a class="φgd φge φu" href="/iq1x0p">mybatis-generator-maven插件与lombok的引入</a><!----></div><!----></footer><is-e class="φbz φh"><div issnippet="" class="φbh"><div id="tcomment"></div>


</div><!----><!----><!----><!----></is-e><!----><!----><!----></is-s><!----></main><!----></div></div></div><is-g class="φch"><div class="φcq"><span class="φbg icon-up"></span><span class="φbg icon-down"></span><!----><span class="φbg icon-toc"></span><!----><span class="φbg icon-search"></span><!----></div><div class="φcj φck"><svg class="φcp"><defs><filter id="dp"><feGaussianBlur in="SourceGraphic" stdDeviation="2"></feGaussianBlur></filter></defs><circle filter="url(#dp)" fill="rgba(0,0,0,.3)" cx="50%" cy="52%" r="44%"></circle><circle cx="50%" cy="50%" r="44%" class="φcl φbb"></circle><circle cx="50%" cy="50%" r="48%" class="φco φba" stroke-dasharray="0% 314.15926%"></circle><!----><g class="φcm"><circle r=".2rem" cx="0" cy="-.8rem"></circle><circle r=".2rem"></circle><circle r=".2rem" cx="0" cy=".8rem"></circle></g><!----></svg></div></is-g><is-n class="φev φf"><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">1 </span><!----><span class="φfc">如何使用</span></a><!----></div><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">2 </span><!----><span class="φfc">PageInfo 中的参数说明</span></a><!----></div><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">3 </span><!----><span class="φfc">PageHelper 使用中的坑</span></a><div class="φex"><a class="φfa φu"><span class="φfb φd">3.1 </span><!----><span class="φfc">需求描述</span></a><!----></div><div class="φex"><a class="φfa φu"><span class="φfb φd">3.2 </span><!----><span class="φfc">解决方法</span></a><div class="φex"><a class="φfa φu"><span class="φfb φd">3.2.1 </span><!----><span class="φfc">方法一</span></a><!----></div><div class="φex"><a class="φfa φu"><span class="φfb φd">3.2.2 </span><!----><span class="φfc">方法二 推荐</span></a><!----></div><!----><!----><!----></div><div class="φex"><a class="φfa φu"><span class="φfb φd">3.3 </span><!----><span class="φfc">原因分析</span></a><!----></div><!----><!----><!----></div><div class="φex φey φn"><a class="φfa φu"><span class="φfb φd">4 </span><!----><span class="φfc">参考资料</span></a><!----></div><!----></is-n><!----><!----></is-a><!-- hexo injector body_begin end --><!-- hexo injector body_end start --><script src="https://cdn.jsdelivr.net/npm/twikoo@1.0.0/dist/twikoo.all.min.js"></script><script src="/runtime.b15aa7186c559b492b7d.js"></script><script src="/polyfills.824ff89b5f3ca4543a31.js"></script><script src="/main.03652fc423a687c817e8.js"></script><!-- hexo injector body_end end -->

</body></html>